diff --git a/customer_behaviour/custom_gym/custom_gym/envs/discrete_buying_events.py b/customer_behaviour/custom_gym/custom_gym/envs/discrete_buying_events.py
index 375e37b..e83be06 100644
--- a/customer_behaviour/custom_gym/custom_gym/envs/discrete_buying_events.py
+++ b/customer_behaviour/custom_gym/custom_gym/envs/discrete_buying_events.py
@@ -51,7 +51,7 @@ class DiscreteBuyingEvents(gym.Env):
             raise NotImplementedError
 
 
-    def generate_expert_trajectories(self, n_experts, n_time_steps, seed=True, out_dir):
+    def generate_expert_trajectories(self, n_experts, n_time_steps, out_dir, seed=True):
         states = []
         actions = []
 
@@ -80,11 +80,11 @@ class DiscreteBuyingEvents(gym.Env):
 
                 temp_actions.append(action)
 
-                if i == sample.shape[1] - 1
+                if i == sample.shape[1] - 1:
                     # The number of states and actions must be equal
                     pass
                 else:
-                    state, _â€š _, _ = self.step(action)
+                    state, _, _, _ = self.step(action)
                     temp_states.append(state)
 
                 i += 1
diff --git a/customer_behaviour/tools/read_npz_file.py b/customer_behaviour/tools/read_npz_file.py
deleted file mode 100644
index edf6d52..0000000
--- a/customer_behaviour/tools/read_npz_file.py
+++ /dev/null
@@ -1,7 +0,0 @@
-from numpy import load
-
-data = load('expert_trajectories.npz', allow_pickle=True)
-lst = data.files
-for item in lst:
-    #print(item)
-    print(data[item])
\ No newline at end of file
diff --git a/main.py b/main.py
index daf5b3b..81d2b0b 100644
--- a/main.py
+++ b/main.py
@@ -6,14 +6,9 @@ Both discrete and continuous action spaces are supported.
 To solve CartPole-v0, run:
     python train_ppo_gym.py --env CartPole-v0
 """
-
-import sys
 import os
-import datetime
 import argparse
-from os.path import join
-#sys.path.append(os.getcwd())
-
+from customer_behaviour.tools.tools import get_env, get_outdir, str2bool, move_dir
 
 import gym
 import custom_gym
@@ -105,46 +100,6 @@ def save_agent_demo(env, agent, out_dir, max_t=2000):
     np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
              actions=np.array(agent_actions, dtype=object))
 
-def get_outdir(algo, case, n_experts, n_categories):
-
-    if not os.path.exists('results'): os.makedirs('results')
-
-    path = join('results', str(algo))
-    if not os.path.exists(path): os.makedirs(path)
-
-    path = join(path, case)
-    if not os.path.exists(path): os.makedirs(path)
-
-    path = join(path, str(n_experts) + '_expert(s)')
-    if not os.path.exists(path): os.makedirs(path)
-
-    path = join(path, str(n_categories) + '_product(s)')
-    if not os.path.exists(path): os.makedirs(path)
-
-    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-    path = join(path, time)
-
-    return path
-
-
-def get_env(case, n_experts):
-    if case == 'discrete_events':
-        env = 'discrete-buying-events-v0'
-    elif case == 'full_receipt':
-        env = ''
-
-    return env
-
-def str2bool(v):
-    if isinstance(v, bool):
-       return v
-    if v.lower() in ('yes', 'True', 't', 'y', '1', 'true'):
-        return True
-    elif v.lower() in ('no', 'False', 'f', 'n', '0', 'false'):
-        return False
-    else:
-        raise argparse.ArgumentTypeError('Boolean value expected.')
-
 
 def main():
     import logging
@@ -154,11 +109,11 @@ def main():
     parser.add_argument('--gpu', type=int, default=0)
     parser.add_argument('--case', type=str, default='discrete_events')
     parser.add_argument('--n_experts', type=int, default=1)
-    parser.add_argument('--n_categories', type=int, default=1)
+    parser.add_argument('--n_products', type=int, default=1)
     parser.add_argument('--seed_expert', type=str2bool, nargs='?',
                         const=True, default=False,
-                        help="Activate nice mode.")
-    parser.add_argument('--n_historic_events', type=int, default=20)
+                        help="Activate expert seed mode.")
+    parser.add_argument('--n_historic_events', type=int, default=7)
     parser.add_argument('--arch', type=str, default='FFSoftmax',
                         choices=('FFSoftmax', 'FFMellowmax',
                                  'FFGaussian'))
@@ -176,7 +131,7 @@ def main():
     parser.add_argument('--weight-decay', type=float, default=0.0)
     parser.add_argument('--demo', action='store_true', default=False)
     parser.add_argument('--load', type=str, default='')
-    parser.add_argument('--load_demo', type=str, default='')
+    #parser.add_argument('--load_demo', type=str, default='')
     parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
     parser.add_argument('--monitor', action='store_true')
     parser.add_argument('--update-interval', type=int, default=128)
@@ -184,21 +139,21 @@ def main():
     parser.add_argument('--epochs', type=int, default=10)
     parser.add_argument('--entropy-coef', type=float, default=0.01)
     args = parser.parse_args()
-    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-    args.env = get_env(args.case, args.n_experts)
-    print(args.seed_expert)
+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_products)
+    args.env = get_env(args.case, args.n_experts)  
 
     logging.basicConfig(level=args.logger_level)
 
     # Set a random seed used in ChainerRL
     misc.set_random_seed(args.seed, gpus=(args.gpu,))
-
     if not (args.demo and args.load):
         args.outdir = experiments.prepare_output_dir(args, args.outdir)
+    temp = args.outdir.split('/')[-1]
+    dst = args.outdir.strip(temp)
 
     def make_env(test):
         env = gym.make(args.env)
-        env.define_case(0, 0, 7*[0])
+        env.initialize_environment(args.n_products, args.n_historic_events, 0)
 
         # Use different random seeds for train and test envs
         env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
@@ -216,12 +171,16 @@ def main():
         return env
 
     sample_env = gym.make(args.env)
-    sample_env.define_case(0, 0, 7*[0])
+    sample_env.initialize_environment(args.n_products, args.n_historic_events, 0)
+    demonstrations = sample_env.generate_expert_trajectories(args.n_experts, args.steps, out_dir=dst, seed=args.seed_expert)
     timestep_limit = sample_env.spec.tags.get(
         'wrapper_config.TimeLimit.max_episode_steps')
     obs_space = sample_env.observation_space
     action_space = sample_env.action_space
 
+    ####-----create_expert data here and take args.seed_expert as input and save as expert_trajectories.npz 
+    # file in dst that file path is our demonstrations variable ----
+
     # Normalize observations based on their empirical mean and variance
 
     obs_normalizer = None                                                                # HarDKODAT
@@ -253,7 +212,7 @@ def main():
         import numpy as np
         from customer_behaviour.algorithms.irl.gail import GAIL
         from customer_behaviour.algorithms.irl.gail import Discriminator
-        demonstrations = np.load(args.load_demo)
+        #demonstrations = np.load(args.load_demo)
         D = Discriminator(gpu=args.gpu)
         agent = GAIL(demonstrations=demonstrations, discriminator=D,
                      model=model, optimizer=opt,
@@ -327,6 +286,12 @@ def main():
             ],
         )
         save_agent_demo(make_env(False), agent, args.outdir)
+    
+    # Move result files to correct folder and remove empty folder
+    move_dir(args.outdir, dst)
+    os.rmdir(args.outdir)
+
+    # Visualization
 
 
 if __name__ == '__main__':
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/10_finish/model.npz b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/10_finish/model.npz
deleted file mode 100644
index 6d7f2be..0000000
Binary files a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/10_finish/model.npz and /dev/null differ
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/10_finish/optimizer.npz b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/10_finish/optimizer.npz
deleted file mode 100644
index eecd553..0000000
Binary files a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/10_finish/optimizer.npz and /dev/null differ
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/args.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/args.txt
deleted file mode 100644
index 83de6ff..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/args.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"algo": "airl", "gpu": -1, "case": "discrete_events", "n_experts": 1, "n_categories": 1, "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01, "outdir": "results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21", "env": "discrete-buying-events-v0"}
\ No newline at end of file
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/command.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/command.txt
deleted file mode 100644
index 032995d..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/command.txt
+++ /dev/null
@@ -1 +0,0 @@
-temp_main.py airl --gpu -1 --case discrete_events --n_experts 1 --n_categories 1 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01
\ No newline at end of file
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/environ.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/environ.txt
deleted file mode 100644
index 9c1bbd9..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/environ.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"TERM_PROGRAM": "Apple_Terminal", "TERM": "xterm-256color", "SHELL": "/bin/bash", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.gjMnJvQ4ux/Render", "TERM_PROGRAM_VERSION": "421.2", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.4I4GqXIb2y/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "HOME": "/Users/victor", "SHLVL": "1", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
\ No newline at end of file
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-diff.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-diff.txt
deleted file mode 100644
index decbde1..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-diff.txt
+++ /dev/null
@@ -1,709 +0,0 @@
-diff --git a/config.ini b/config.ini
-deleted file mode 100644
-index 0b70f3c..0000000
---- a/config.ini
-+++ /dev/null
-@@ -1,11 +0,0 @@
--[DEFAULT]
--
--
--[discrete_events]
--N_EXPERTS = 1
--N_PRODUCTS = 1
--
--[full_receipts]
--N_EXPERTS = 1
--N_PRODUCTS = 6
--
-diff --git a/customer_behaviour/algorithms/irl/airl/discriminator.py b/customer_behaviour/algorithms/irl/airl/discriminator.py
-index 931e98e..cdc5c9d 100755
---- a/customer_behaviour/algorithms/irl/airl/discriminator.py
-+++ b/customer_behaviour/algorithms/irl/airl/discriminator.py
-@@ -1,6 +1,6 @@
- import chainer
- import chainer.functions as F
--from irl.common.model import MLP
-+from customer_behaviour.algorithms.irl.common.model import MLP
- from chainer.link_hooks.spectral_normalization import SpectralNormalization
- 
- 
-diff --git a/customer_behaviour/algorithms/irl/common/utils/__init__.py b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-index f808b8c..2c9d8c4 100755
---- a/customer_behaviour/algorithms/irl/common/utils/__init__.py
-+++ b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-@@ -1 +1 @@
--from irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-+from customer_behaviour.algorithms.irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-deleted file mode 100644
-index f0dec34..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-deleted file mode 100644
-index eecd553..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-deleted file mode 100644
-index c122e59..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"algo": "airl", "gpu": -1, "env": "discrete-buying-events-v0", "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "outdir": "results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43", "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-deleted file mode 100644
-index 913e5b6..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--customer_behaviour/algorithms/train_gym.py airl --gpu -1 --env discrete-buying-events-v0 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01 --outdir results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-deleted file mode 100644
-index ef43d43..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"TERM_PROGRAM": "Apple_Terminal", "SHELL": "/bin/bash", "TERM": "xterm-256color", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.JuAPseFAEM/Render", "TERM_PROGRAM_VERSION": "421.2", "OLDPWD": "/Users/victor/Documents/CAS_2/Master_thesis", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.b16K4t4cKk/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "SHLVL": "1", "HOME": "/Users/victor", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-deleted file mode 100644
-index 341b94d..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-+++ /dev/null
-@@ -1,30 +0,0 @@
--diff --git a/expert_trajectories.npz b/expert_trajectories.npz
--index 6fd7b82..04a5abf 100644
--Binary files a/expert_trajectories.npz and b/expert_trajectories.npz differ
--diff --git a/main.py b/main.py
--index 60a144f..adf5222 100644
----- a/main.py
--+++ b/main.py
--@@ -19,12 +19,10 @@ def main(case = 'discrete_events'):
-- 
--     outdir = get_outdir(args.case, args.n_experts, n_categories=1)
-- 
---    n_experts = 1
---
--     demo_states = []
--     demo_actions = []
-- 
---    for i in range(n_experts):
--+    for i in range(args.n_experts):
--         usr = User(time_steps = 128)
--         states, actions = usr.generate_trajectory()
--         demo_states.append(states)
--@@ -33,7 +31,7 @@ def main(case = 'discrete_events'):
--     PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--     np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--              actions=np.array(demo_actions, dtype=object)) 
---    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--+    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01', '--outdir', outdir]
--     s = subprocess.Popen(command)
-- 
-- 
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-deleted file mode 100644
-index c32b34f..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-deleted file mode 100644
-index 4286080..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-+++ /dev/null
-@@ -1,205 +0,0 @@
--commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 15:08:07 2020 +0100
--
--    updated main
--
--commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:57:39 2020 +0100
--
--    main hej
--
--commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
--Merge: 551fe5f 8737870
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:50:41 2020 +0100
--
--    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
--
--commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:47:48 2020 +0100
--
--    fixed main
--
--commit 8737870c484cb6b62516b732984a5a89d49758c9
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 14:44:23 2020 +0100
--
--    added fcn define_case()
--
--commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 13:22:18 2020 +0100
--
--    hej
--
--commit 989a9ddbce8c70f8884960c940dff5cb85abe953
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 17:12:55 2020 +0100
--
--    bra skit
--
--commit fcf59768c112e2f710499a11a083ddbf926e90f1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:57:23 2020 +0100
--
--    fixed main
--
--commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:36:26 2020 +0100
--
--    installed configparser, created config.ini and main.py
--
--commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:23:36 2020 +0100
--
--    changed name of folders
--
--commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 15:48:33 2020 +0100
--
--    changed structure, added __init.py files
--
--commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:11:39 2020 +0100
--
--    changed structure
--
--commit 28daae8a8544c14b37f99e8726991791996ad55a
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:09:29 2020 +0100
--
--    Changed structure of repo
--
--commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 13:05:51 2020 +0100
--
--    updated code to get GAIL to run
--
--commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 10:41:03 2020 +0100
--
--    added results
--
--commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:56:40 2020 +0100
--
--    fin
--
--commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:43:09 2020 +0100
--
--    hgi
--
--commit faf34d5f495f4f5424279e5823d168af86fd7291
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:38:52 2020 +0100
--
--    fixed requirements.txt
--
--commit d0bbd5cabbc023ddc00945620543c56372367146
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:08:25 2020 +0100
--
--    added deepirl
--
--commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:06:32 2020 +0100
--
--    fixni
--
--commit 13215698e0d7d48d404df1075c540037bc470a59
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:00:49 2020 +0100
--
--    added files for custom_env
--
--commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 16:09:26 2020 +0100
--
--    fixed .npz file
--
--commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Tue Feb 4 16:08:32 2020 +0100
--
--    created env
--
--commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:54:48 2020 +0100
--
--    added traj
--
--commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
--Merge: 89e455b 585fa30
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:39:11 2020 +0100
--
--    gij
--
--commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:38:22 2020 +0100
--
--    gg
--
--commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:36:44 2020 +0100
--
--    changed in user class
--
--commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:19 2020 +0100
--
--    Delete gail_pendulum.zip
--
--commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:10 2020 +0100
--
--    Delete expert_pendulum.npz
--
--commit 5d83000b84635f517ffd723a2f47424e75a16f80
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 16:30:13 2020 +0100
--
--    feature extraction + plots changed
--
--commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 11:57:18 2020 +0100
--
--    added generate_data.py
--
--commit 216496211fab6141cd7fcc891228f8692350a3ff
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 08:41:26 2020 +0100
--
--    Tested different ways to compare time series
--
--commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Jan 21 15:17:48 2020 +0100
--
--    first commit
--
--commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Jan 20 09:53:42 2020 +0100
--
--    Initial commit
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-deleted file mode 100644
-index 953dca0..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-+++ /dev/null
-@@ -1,16 +0,0 @@
--On branch master
--Your branch is up to date with 'origin/master'.
--
--Changes not staged for commit:
--  (use "git add <file>..." to update what will be committed)
--  (use "git checkout -- <file>..." to discard changes in working directory)
--
--	modified:   expert_trajectories.npz
--	modified:   main.py
--
--Untracked files:
--  (use "git add <file>..." to include in what will be committed)
--
--	results/discrete_events/
--
--no changes added to commit (use "git add" and/or "git commit -a")
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-deleted file mode 100644
-index 99dfa5e..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-deleted file mode 100644
-index fc48d49..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz and /dev/null differ
-diff --git a/temp_main.py b/temp_main.py
-index a507968..6e5bc93 100644
---- a/temp_main.py
-+++ b/temp_main.py
-@@ -1,47 +1,318 @@
--from customer_behaviour.tools import dgm as dgm
--from customer_behaviour.tools.generate_data import User 
-+"""An example of training PPO against OpenAI Gym Envs.
-+
-+This script is an example of training a PPO agent against OpenAI Gym envs.
-+Both discrete and continuous action spaces are supported.
-+
-+To solve CartPole-v0, run:
-+    python train_ppo_gym.py --env CartPole-v0
-+"""
-+
-+import sys
- import os
-+import datetime
- import argparse
--import subprocess
--import numpy as np
-+from os.path import join
-+#sys.path.append(os.getcwd())
-+
-+
-+import gym
-+import custom_gym
-+import gym.wrappers
-+
-+import chainer
-+from chainer import functions as F
-+import chainerrl
-+
-+from chainerrl.agents import a3c
-+from chainerrl.agents import PPO
-+from chainerrl import experiments
-+from chainerrl import links
-+from chainerrl import misc
-+from chainerrl.optimizers.nonbias_weight_decay import NonbiasWeightDecay
-+from chainerrl import policies
-+
-+
-+class A3CFFSoftmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward softmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.SoftmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFMellowmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward mellowmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.MellowmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFGaussian(chainer.Chain, a3c.A3CModel):
-+    """An example of A3C feedforward Gaussian policy."""
-+
-+    def __init__(self, obs_size, action_space,
-+                 n_hidden_layers=2, n_hidden_channels=64,
-+                 bound_mean=None):
-+        assert bound_mean in [False, True]
-+        super().__init__()
-+        hidden_sizes = (n_hidden_channels,) * n_hidden_layers
-+        with self.init_scope():
-+            self.pi = policies.FCGaussianPolicyWithStateIndependentCovariance(
-+                obs_size, action_space.low.size,
-+                n_hidden_layers, n_hidden_channels,
-+                var_type='diagonal', nonlinearity=F.tanh,
-+                bound_mean=bound_mean,
-+                min_action=action_space.low, max_action=action_space.high,
-+                mean_wscale=1e-2)
-+            self.v = links.MLP(obs_size, 1, hidden_sizes=hidden_sizes)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+def save_agent_demo(env, agent, out_dir, max_t=2000):
-+    import numpy as np
-+    r, t = 0, 0
-+    agent_observations = []
-+    agent_actions = []
-+    while t < max_t:
-+        agent_observations.append([])
-+        agent_actions.append([])
-+        obs = env.reset()
-+        while True:
-+            act = agent.act(obs)
-+            agent_observations[-1].append(obs)
-+            agent_actions[-1].append(act)
-+            obs, reward, done, _ = env.step(act)
-+            t += 1
-+            r += reward
-+            if done or t >= max_t:
-+                print(t)
-+                break
-+
-+    # save numpy array consists of lists
-+    np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
-+             actions=np.array(agent_actions, dtype=object))
-+
-+def get_outdir(algo, case, n_experts, n_categories):
-+
-+    if not os.path.exists('results'): os.makedirs('results')
-+
-+    path = join('results', str(algo))
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, case)
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_experts) + '_expert(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_categories) + '_product(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-+    path = join(path, time)
-+
-+    return path
-+
-+
-+def get_env(case, n_experts):
-+    if case == 'discrete_events':
-+        env = 'discrete-buying-events-v0'
-+    elif case == 'full_receipt':
-+        env = ''
-+
-+    return env
-+
-+
-+def main():
-+    import logging
- 
--def main(case = 'discrete_events'):
-     parser = argparse.ArgumentParser()
-     parser.add_argument('algo', default='gail', choices=['gail', 'airl'], type=str)
--    parser.add_argument('--case', type=str, default=case)
-+    parser.add_argument('--gpu', type=int, default=0)
-+    parser.add_argument('--case', type=str, default='discrete_events')
-     parser.add_argument('--n_experts', type=int, default=1)
--    parser.add_argument('--n_steps', type=int, default=10000)
-+    parser.add_argument('--n_categories', type=int, default=1)
-+    parser.add_argument('--arch', type=str, default='FFGaussian',
-+                        choices=('FFSoftmax', 'FFMellowmax',
-+                                 'FFGaussian'))
-+    parser.add_argument('--bound-mean', action='store_true')
-+    parser.add_argument('--seed', type=int, default=0,
-+                        help='Random seed [0, 2 ** 32)')
-+    #parser.add_argument('--outdir', type=str, default='results', help='Directory path to save output files.'' If it does not exist, it will be created.')
-+    parser.add_argument('--steps', type=int, default=10 ** 6)
-+    parser.add_argument('--eval-interval', type=int, default=10000)
-+    parser.add_argument('--eval-n-runs', type=int, default=10)
-+    parser.add_argument('--reward-scale-factor', type=float, default=1e-2)
-+    parser.add_argument('--standardize-advantages', action='store_true')
-+    parser.add_argument('--render', action='store_true', default=False)
-+    parser.add_argument('--lr', type=float, default=3e-4)
-+    parser.add_argument('--weight-decay', type=float, default=0.0)
-+    parser.add_argument('--demo', action='store_true', default=False)
-+    parser.add_argument('--load', type=str, default='')
-+    parser.add_argument('--load_demo', type=str, default='')
-+    parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
-+    parser.add_argument('--monitor', action='store_true')
-+
-+    parser.add_argument('--update-interval', type=int, default=2048)
-+    parser.add_argument('--batchsize', type=int, default=64)
-+    parser.add_argument('--epochs', type=int, default=10)
-+    parser.add_argument('--entropy-coef', type=float, default=0.0)
-     args = parser.parse_args()
-+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-+    args.env = get_env(args.case, args.n_experts)
- 
--    env = find_env(args.case, args.n_experts)
-+    logging.basicConfig(level=args.logger_level)
- 
--    n_experts = 1
-+    # Set a random seed used in ChainerRL
-+    misc.set_random_seed(args.seed, gpus=(args.gpu,))
- 
--    demo_states = []
--    demo_actions = []
-+    if not (args.demo and args.load):
-+        args.outdir = experiments.prepare_output_dir(args, args.outdir)
- 
--    for i in range(n_experts):
--        usr = User(time_steps = 128)
--        states, actions = usr.generate_trajectory()
--        demo_states.append(states)
--        demo_actions.append(actions)
-+    def make_env(test):
-+        env = gym.make(args.env)
-+        env.define_case(0, 0, 7*[0])
- 
--    PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--    np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--             actions=np.array(demo_actions, dtype=object)) 
--    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--    s = subprocess.Popen(command)
-+        # Use different random seeds for train and test envs
-+        env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
-+        env.seed(env_seed)
-+        # Cast observations to float32 because our model uses float32
-+        env = chainerrl.wrappers.CastObservationToFloat32(env)
-+        if args.monitor:
-+            env = gym.wrappers.Monitor(env, args.outdir)
-+        if not test:
-+            # Scale rewards (and thus returns) to a reasonable range so that
-+            # training is easier
-+            env = chainerrl.wrappers.ScaleReward(env, args.reward_scale_factor)
-+        if args.render:
-+            env = chainerrl.wrappers.Render(env)
-+        return env
- 
--def find_env(case, n_experts):
--    if case == 'discrete_events':
--        if n_experts == 1:
--            env = 'discrete-buying-events-v0'
-+    sample_env = gym.make(args.env)
-+    sample_env.define_case(0, 0, 7*[0])
-+    timestep_limit = sample_env.spec.tags.get(
-+        'wrapper_config.TimeLimit.max_episode_steps')
-+    obs_space = sample_env.observation_space
-+    action_space = sample_env.action_space
- 
--    if case == 'full_receipt':
--        if n_experts == 1:
--            env = ''
-+    # Normalize observations based on their empirical mean and variance
- 
--    return env
-+    obs_normalizer = None                                                                # HarDKODAT
-+    #chainerrl.links.EmpiricalNormalization(obs_space.low.size, clip_threshold=5)
-+
-+    # Switch policy types accordingly to action space types
-+    if args.arch == 'FFSoftmax':
-+        model = A3CFFSoftmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFMellowmax':
-+        model = A3CFFMellowmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFGaussian':
-+        model = A3CFFGaussian(obs_space.low.size, action_space,
-+                              bound_mean=args.bound_mean)
-+
-+    opt = chainer.optimizers.Adam(alpha=args.lr, eps=1e-5)
-+    opt.setup(model)
-+    if args.weight_decay > 0:
-+        opt.add_hook(NonbiasWeightDecay(args.weight_decay))
-+    if args.algo == 'ppo':
-+        agent = PPO(model, opt,
-+                    obs_normalizer=obs_normalizer,
-+                    gpu=args.gpu,
-+                    update_interval=args.update_interval,
-+                    minibatch_size=args.batchsize, epochs=args.epochs,
-+                    clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                    standardize_advantages=args.standardize_advantages,
-+                    )
-+    elif args.algo == 'gail':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.gail import GAIL
-+        from customer_behaviour.algorithms.irl.gail import Discriminator
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = GAIL(demonstrations=demonstrations, discriminator=D,
-+                     model=model, optimizer=opt,
-+                     obs_normalizer=obs_normalizer,
-+                     gpu=args.gpu,
-+                     update_interval=args.update_interval,
-+                     minibatch_size=args.batchsize, epochs=args.epochs,
-+                     clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                     standardize_advantages=args.standardize_advantages,)
-+    elif args.algo == 'airl':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.airl import AIRL as Agent
-+        from customer_behaviour.algorithms.irl.airl import Discriminator
-+        # obs_normalizer = None
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = Agent(demonstrations=demonstrations, discriminator=D,
-+                      model=model, optimizer=opt,
-+                      obs_normalizer=obs_normalizer,
-+                      gpu=args.gpu,
-+                      update_interval=args.update_interval,
-+                      minibatch_size=args.batchsize, epochs=args.epochs,
-+                      clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                      standardize_advantages=args.standardize_advantages,)
-+
-+    if args.load:
-+        agent.load(args.load)
-+
-+    if args.demo:
-+        env = make_env(True)
-+        eval_stats = experiments.eval_performance(
-+            env=env,
-+            agent=agent,
-+            n_steps=None,
-+            n_episodes=args.eval_n_runs,
-+            max_episode_len=timestep_limit)
-+        print('n_runs: {} mean: {} median: {} stdev {}'.format(
-+            args.eval_n_runs, eval_stats['mean'], eval_stats['median'],
-+            eval_stats['stdev']))
-+        outdir = args.load if args.load else args.outdir
-+        save_agent_demo(make_env(False), agent, outdir)
-+    else:
-+        # Linearly decay the learning rate to zero
-+        def lr_setter(env, agent, value):
-+            agent.optimizer.alpha = value
-+
-+        lr_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, args.lr, 0, lr_setter)
-+
-+        # Linearly decay the clipping parameter to zero
-+        def clip_eps_setter(env, agent, value):
-+            agent.clip_eps = max(value, 1e-8)
-+
-+        clip_eps_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, 0.2, 0, clip_eps_setter)
-+
-+        experiments.train_agent_with_evaluation(
-+            agent=agent,
-+            env=make_env(False),
-+            eval_env=make_env(True),
-+            outdir=args.outdir,
-+            steps=args.steps,
-+            eval_n_steps=None,
-+            eval_n_episodes=args.eval_n_runs,
-+            eval_interval=args.eval_interval,
-+            train_max_episode_len=timestep_limit,
-+            save_best_so_far_agent=False,
-+            step_hooks=[
-+                lr_decay_hook,
-+                clip_eps_decay_hook,
-+            ],
-+        )
-+        save_agent_demo(make_env(False), agent, args.outdir)
- 
- 
- if __name__ == '__main__':
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-head.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-head.txt
deleted file mode 100644
index ed95f27..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-head.txt
+++ /dev/null
@@ -1 +0,0 @@
-92fa4b893bc749ddaa3a3d107d383d7ad35748f5
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-log.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-log.txt
deleted file mode 100644
index a91c7dc..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-log.txt
+++ /dev/null
@@ -1,211 +0,0 @@
-commit 92fa4b893bc749ddaa3a3d107d383d7ad35748f5
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Mon Feb 10 08:44:27 2020 +0100
-
-    kfj
-
-commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 15:08:07 2020 +0100
-
-    updated main
-
-commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:57:39 2020 +0100
-
-    main hej
-
-commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
-Merge: 551fe5f 8737870
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:50:41 2020 +0100
-
-    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
-
-commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:47:48 2020 +0100
-
-    fixed main
-
-commit 8737870c484cb6b62516b732984a5a89d49758c9
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 14:44:23 2020 +0100
-
-    added fcn define_case()
-
-commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 13:22:18 2020 +0100
-
-    hej
-
-commit 989a9ddbce8c70f8884960c940dff5cb85abe953
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 17:12:55 2020 +0100
-
-    bra skit
-
-commit fcf59768c112e2f710499a11a083ddbf926e90f1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:57:23 2020 +0100
-
-    fixed main
-
-commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:36:26 2020 +0100
-
-    installed configparser, created config.ini and main.py
-
-commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:23:36 2020 +0100
-
-    changed name of folders
-
-commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 15:48:33 2020 +0100
-
-    changed structure, added __init.py files
-
-commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:11:39 2020 +0100
-
-    changed structure
-
-commit 28daae8a8544c14b37f99e8726991791996ad55a
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:09:29 2020 +0100
-
-    Changed structure of repo
-
-commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 13:05:51 2020 +0100
-
-    updated code to get GAIL to run
-
-commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 10:41:03 2020 +0100
-
-    added results
-
-commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:56:40 2020 +0100
-
-    fin
-
-commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:43:09 2020 +0100
-
-    hgi
-
-commit faf34d5f495f4f5424279e5823d168af86fd7291
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:38:52 2020 +0100
-
-    fixed requirements.txt
-
-commit d0bbd5cabbc023ddc00945620543c56372367146
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:08:25 2020 +0100
-
-    added deepirl
-
-commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:06:32 2020 +0100
-
-    fixni
-
-commit 13215698e0d7d48d404df1075c540037bc470a59
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:00:49 2020 +0100
-
-    added files for custom_env
-
-commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 16:09:26 2020 +0100
-
-    fixed .npz file
-
-commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Tue Feb 4 16:08:32 2020 +0100
-
-    created env
-
-commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:54:48 2020 +0100
-
-    added traj
-
-commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
-Merge: 89e455b 585fa30
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:39:11 2020 +0100
-
-    gij
-
-commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:38:22 2020 +0100
-
-    gg
-
-commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:36:44 2020 +0100
-
-    changed in user class
-
-commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:19 2020 +0100
-
-    Delete gail_pendulum.zip
-
-commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:10 2020 +0100
-
-    Delete expert_pendulum.npz
-
-commit 5d83000b84635f517ffd723a2f47424e75a16f80
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 16:30:13 2020 +0100
-
-    feature extraction + plots changed
-
-commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 11:57:18 2020 +0100
-
-    added generate_data.py
-
-commit 216496211fab6141cd7fcc891228f8692350a3ff
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 08:41:26 2020 +0100
-
-    Tested different ways to compare time series
-
-commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Jan 21 15:17:48 2020 +0100
-
-    first commit
-
-commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Jan 20 09:53:42 2020 +0100
-
-    Initial commit
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-status.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-status.txt
deleted file mode 100644
index b60afb2..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/git-status.txt
+++ /dev/null
@@ -1,29 +0,0 @@
-On branch master
-Your branch is up to date with 'origin/master'.
-
-Changes not staged for commit:
-  (use "git add/rm <file>..." to update what will be committed)
-  (use "git checkout -- <file>..." to discard changes in working directory)
-
-	deleted:    config.ini
-	modified:   customer_behaviour/algorithms/irl/airl/discriminator.py
-	modified:   customer_behaviour/algorithms/irl/common/utils/__init__.py
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-	modified:   temp_main.py
-
-Untracked files:
-  (use "git add <file>..." to include in what will be committed)
-
-	results/airl/
-
-no changes added to commit (use "git add" and/or "git commit -a")
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/scores.txt b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/scores.txt
deleted file mode 100644
index 99dfa5e..0000000
--- a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/scores.txt
+++ /dev/null
@@ -1 +0,0 @@
-steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
diff --git a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/trajectories.npz b/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/trajectories.npz
deleted file mode 100644
index fc48d49..0000000
Binary files a/results/airl/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-21/20200210T091921.884752/trajectories.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/10_finish/model.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/10_finish/model.npz
deleted file mode 100644
index b3d88e6..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/10_finish/model.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/10_finish/optimizer.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/10_finish/optimizer.npz
deleted file mode 100644
index eecd553..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/10_finish/optimizer.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/args.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/args.txt
deleted file mode 100644
index 42471fd..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/args.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"algo": "gail", "gpu": -1, "case": "discrete_events", "n_experts": 1, "n_categories": 1, "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01, "outdir": "results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39", "env": "discrete-buying-events-v0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/command.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/command.txt
deleted file mode 100644
index 2b0c892..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/command.txt
+++ /dev/null
@@ -1 +0,0 @@
-temp_main.py gail --gpu -1 --case discrete_events --n_experts 1 --n_categories 1 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/environ.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/environ.txt
deleted file mode 100644
index 9c1bbd9..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/environ.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"TERM_PROGRAM": "Apple_Terminal", "TERM": "xterm-256color", "SHELL": "/bin/bash", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.gjMnJvQ4ux/Render", "TERM_PROGRAM_VERSION": "421.2", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.4I4GqXIb2y/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "HOME": "/Users/victor", "SHLVL": "1", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-diff.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-diff.txt
deleted file mode 100644
index decbde1..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-diff.txt
+++ /dev/null
@@ -1,709 +0,0 @@
-diff --git a/config.ini b/config.ini
-deleted file mode 100644
-index 0b70f3c..0000000
---- a/config.ini
-+++ /dev/null
-@@ -1,11 +0,0 @@
--[DEFAULT]
--
--
--[discrete_events]
--N_EXPERTS = 1
--N_PRODUCTS = 1
--
--[full_receipts]
--N_EXPERTS = 1
--N_PRODUCTS = 6
--
-diff --git a/customer_behaviour/algorithms/irl/airl/discriminator.py b/customer_behaviour/algorithms/irl/airl/discriminator.py
-index 931e98e..cdc5c9d 100755
---- a/customer_behaviour/algorithms/irl/airl/discriminator.py
-+++ b/customer_behaviour/algorithms/irl/airl/discriminator.py
-@@ -1,6 +1,6 @@
- import chainer
- import chainer.functions as F
--from irl.common.model import MLP
-+from customer_behaviour.algorithms.irl.common.model import MLP
- from chainer.link_hooks.spectral_normalization import SpectralNormalization
- 
- 
-diff --git a/customer_behaviour/algorithms/irl/common/utils/__init__.py b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-index f808b8c..2c9d8c4 100755
---- a/customer_behaviour/algorithms/irl/common/utils/__init__.py
-+++ b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-@@ -1 +1 @@
--from irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-+from customer_behaviour.algorithms.irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-deleted file mode 100644
-index f0dec34..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-deleted file mode 100644
-index eecd553..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-deleted file mode 100644
-index c122e59..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"algo": "airl", "gpu": -1, "env": "discrete-buying-events-v0", "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "outdir": "results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43", "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-deleted file mode 100644
-index 913e5b6..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--customer_behaviour/algorithms/train_gym.py airl --gpu -1 --env discrete-buying-events-v0 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01 --outdir results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-deleted file mode 100644
-index ef43d43..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"TERM_PROGRAM": "Apple_Terminal", "SHELL": "/bin/bash", "TERM": "xterm-256color", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.JuAPseFAEM/Render", "TERM_PROGRAM_VERSION": "421.2", "OLDPWD": "/Users/victor/Documents/CAS_2/Master_thesis", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.b16K4t4cKk/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "SHLVL": "1", "HOME": "/Users/victor", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-deleted file mode 100644
-index 341b94d..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-+++ /dev/null
-@@ -1,30 +0,0 @@
--diff --git a/expert_trajectories.npz b/expert_trajectories.npz
--index 6fd7b82..04a5abf 100644
--Binary files a/expert_trajectories.npz and b/expert_trajectories.npz differ
--diff --git a/main.py b/main.py
--index 60a144f..adf5222 100644
----- a/main.py
--+++ b/main.py
--@@ -19,12 +19,10 @@ def main(case = 'discrete_events'):
-- 
--     outdir = get_outdir(args.case, args.n_experts, n_categories=1)
-- 
---    n_experts = 1
---
--     demo_states = []
--     demo_actions = []
-- 
---    for i in range(n_experts):
--+    for i in range(args.n_experts):
--         usr = User(time_steps = 128)
--         states, actions = usr.generate_trajectory()
--         demo_states.append(states)
--@@ -33,7 +31,7 @@ def main(case = 'discrete_events'):
--     PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--     np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--              actions=np.array(demo_actions, dtype=object)) 
---    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--+    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01', '--outdir', outdir]
--     s = subprocess.Popen(command)
-- 
-- 
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-deleted file mode 100644
-index c32b34f..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-deleted file mode 100644
-index 4286080..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-+++ /dev/null
-@@ -1,205 +0,0 @@
--commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 15:08:07 2020 +0100
--
--    updated main
--
--commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:57:39 2020 +0100
--
--    main hej
--
--commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
--Merge: 551fe5f 8737870
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:50:41 2020 +0100
--
--    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
--
--commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:47:48 2020 +0100
--
--    fixed main
--
--commit 8737870c484cb6b62516b732984a5a89d49758c9
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 14:44:23 2020 +0100
--
--    added fcn define_case()
--
--commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 13:22:18 2020 +0100
--
--    hej
--
--commit 989a9ddbce8c70f8884960c940dff5cb85abe953
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 17:12:55 2020 +0100
--
--    bra skit
--
--commit fcf59768c112e2f710499a11a083ddbf926e90f1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:57:23 2020 +0100
--
--    fixed main
--
--commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:36:26 2020 +0100
--
--    installed configparser, created config.ini and main.py
--
--commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:23:36 2020 +0100
--
--    changed name of folders
--
--commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 15:48:33 2020 +0100
--
--    changed structure, added __init.py files
--
--commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:11:39 2020 +0100
--
--    changed structure
--
--commit 28daae8a8544c14b37f99e8726991791996ad55a
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:09:29 2020 +0100
--
--    Changed structure of repo
--
--commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 13:05:51 2020 +0100
--
--    updated code to get GAIL to run
--
--commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 10:41:03 2020 +0100
--
--    added results
--
--commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:56:40 2020 +0100
--
--    fin
--
--commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:43:09 2020 +0100
--
--    hgi
--
--commit faf34d5f495f4f5424279e5823d168af86fd7291
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:38:52 2020 +0100
--
--    fixed requirements.txt
--
--commit d0bbd5cabbc023ddc00945620543c56372367146
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:08:25 2020 +0100
--
--    added deepirl
--
--commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:06:32 2020 +0100
--
--    fixni
--
--commit 13215698e0d7d48d404df1075c540037bc470a59
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:00:49 2020 +0100
--
--    added files for custom_env
--
--commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 16:09:26 2020 +0100
--
--    fixed .npz file
--
--commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Tue Feb 4 16:08:32 2020 +0100
--
--    created env
--
--commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:54:48 2020 +0100
--
--    added traj
--
--commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
--Merge: 89e455b 585fa30
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:39:11 2020 +0100
--
--    gij
--
--commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:38:22 2020 +0100
--
--    gg
--
--commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:36:44 2020 +0100
--
--    changed in user class
--
--commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:19 2020 +0100
--
--    Delete gail_pendulum.zip
--
--commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:10 2020 +0100
--
--    Delete expert_pendulum.npz
--
--commit 5d83000b84635f517ffd723a2f47424e75a16f80
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 16:30:13 2020 +0100
--
--    feature extraction + plots changed
--
--commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 11:57:18 2020 +0100
--
--    added generate_data.py
--
--commit 216496211fab6141cd7fcc891228f8692350a3ff
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 08:41:26 2020 +0100
--
--    Tested different ways to compare time series
--
--commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Jan 21 15:17:48 2020 +0100
--
--    first commit
--
--commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Jan 20 09:53:42 2020 +0100
--
--    Initial commit
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-deleted file mode 100644
-index 953dca0..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-+++ /dev/null
-@@ -1,16 +0,0 @@
--On branch master
--Your branch is up to date with 'origin/master'.
--
--Changes not staged for commit:
--  (use "git add <file>..." to update what will be committed)
--  (use "git checkout -- <file>..." to discard changes in working directory)
--
--	modified:   expert_trajectories.npz
--	modified:   main.py
--
--Untracked files:
--  (use "git add <file>..." to include in what will be committed)
--
--	results/discrete_events/
--
--no changes added to commit (use "git add" and/or "git commit -a")
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-deleted file mode 100644
-index 99dfa5e..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-deleted file mode 100644
-index fc48d49..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz and /dev/null differ
-diff --git a/temp_main.py b/temp_main.py
-index a507968..6e5bc93 100644
---- a/temp_main.py
-+++ b/temp_main.py
-@@ -1,47 +1,318 @@
--from customer_behaviour.tools import dgm as dgm
--from customer_behaviour.tools.generate_data import User 
-+"""An example of training PPO against OpenAI Gym Envs.
-+
-+This script is an example of training a PPO agent against OpenAI Gym envs.
-+Both discrete and continuous action spaces are supported.
-+
-+To solve CartPole-v0, run:
-+    python train_ppo_gym.py --env CartPole-v0
-+"""
-+
-+import sys
- import os
-+import datetime
- import argparse
--import subprocess
--import numpy as np
-+from os.path import join
-+#sys.path.append(os.getcwd())
-+
-+
-+import gym
-+import custom_gym
-+import gym.wrappers
-+
-+import chainer
-+from chainer import functions as F
-+import chainerrl
-+
-+from chainerrl.agents import a3c
-+from chainerrl.agents import PPO
-+from chainerrl import experiments
-+from chainerrl import links
-+from chainerrl import misc
-+from chainerrl.optimizers.nonbias_weight_decay import NonbiasWeightDecay
-+from chainerrl import policies
-+
-+
-+class A3CFFSoftmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward softmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.SoftmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFMellowmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward mellowmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.MellowmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFGaussian(chainer.Chain, a3c.A3CModel):
-+    """An example of A3C feedforward Gaussian policy."""
-+
-+    def __init__(self, obs_size, action_space,
-+                 n_hidden_layers=2, n_hidden_channels=64,
-+                 bound_mean=None):
-+        assert bound_mean in [False, True]
-+        super().__init__()
-+        hidden_sizes = (n_hidden_channels,) * n_hidden_layers
-+        with self.init_scope():
-+            self.pi = policies.FCGaussianPolicyWithStateIndependentCovariance(
-+                obs_size, action_space.low.size,
-+                n_hidden_layers, n_hidden_channels,
-+                var_type='diagonal', nonlinearity=F.tanh,
-+                bound_mean=bound_mean,
-+                min_action=action_space.low, max_action=action_space.high,
-+                mean_wscale=1e-2)
-+            self.v = links.MLP(obs_size, 1, hidden_sizes=hidden_sizes)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+def save_agent_demo(env, agent, out_dir, max_t=2000):
-+    import numpy as np
-+    r, t = 0, 0
-+    agent_observations = []
-+    agent_actions = []
-+    while t < max_t:
-+        agent_observations.append([])
-+        agent_actions.append([])
-+        obs = env.reset()
-+        while True:
-+            act = agent.act(obs)
-+            agent_observations[-1].append(obs)
-+            agent_actions[-1].append(act)
-+            obs, reward, done, _ = env.step(act)
-+            t += 1
-+            r += reward
-+            if done or t >= max_t:
-+                print(t)
-+                break
-+
-+    # save numpy array consists of lists
-+    np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
-+             actions=np.array(agent_actions, dtype=object))
-+
-+def get_outdir(algo, case, n_experts, n_categories):
-+
-+    if not os.path.exists('results'): os.makedirs('results')
-+
-+    path = join('results', str(algo))
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, case)
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_experts) + '_expert(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_categories) + '_product(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-+    path = join(path, time)
-+
-+    return path
-+
-+
-+def get_env(case, n_experts):
-+    if case == 'discrete_events':
-+        env = 'discrete-buying-events-v0'
-+    elif case == 'full_receipt':
-+        env = ''
-+
-+    return env
-+
-+
-+def main():
-+    import logging
- 
--def main(case = 'discrete_events'):
-     parser = argparse.ArgumentParser()
-     parser.add_argument('algo', default='gail', choices=['gail', 'airl'], type=str)
--    parser.add_argument('--case', type=str, default=case)
-+    parser.add_argument('--gpu', type=int, default=0)
-+    parser.add_argument('--case', type=str, default='discrete_events')
-     parser.add_argument('--n_experts', type=int, default=1)
--    parser.add_argument('--n_steps', type=int, default=10000)
-+    parser.add_argument('--n_categories', type=int, default=1)
-+    parser.add_argument('--arch', type=str, default='FFGaussian',
-+                        choices=('FFSoftmax', 'FFMellowmax',
-+                                 'FFGaussian'))
-+    parser.add_argument('--bound-mean', action='store_true')
-+    parser.add_argument('--seed', type=int, default=0,
-+                        help='Random seed [0, 2 ** 32)')
-+    #parser.add_argument('--outdir', type=str, default='results', help='Directory path to save output files.'' If it does not exist, it will be created.')
-+    parser.add_argument('--steps', type=int, default=10 ** 6)
-+    parser.add_argument('--eval-interval', type=int, default=10000)
-+    parser.add_argument('--eval-n-runs', type=int, default=10)
-+    parser.add_argument('--reward-scale-factor', type=float, default=1e-2)
-+    parser.add_argument('--standardize-advantages', action='store_true')
-+    parser.add_argument('--render', action='store_true', default=False)
-+    parser.add_argument('--lr', type=float, default=3e-4)
-+    parser.add_argument('--weight-decay', type=float, default=0.0)
-+    parser.add_argument('--demo', action='store_true', default=False)
-+    parser.add_argument('--load', type=str, default='')
-+    parser.add_argument('--load_demo', type=str, default='')
-+    parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
-+    parser.add_argument('--monitor', action='store_true')
-+
-+    parser.add_argument('--update-interval', type=int, default=2048)
-+    parser.add_argument('--batchsize', type=int, default=64)
-+    parser.add_argument('--epochs', type=int, default=10)
-+    parser.add_argument('--entropy-coef', type=float, default=0.0)
-     args = parser.parse_args()
-+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-+    args.env = get_env(args.case, args.n_experts)
- 
--    env = find_env(args.case, args.n_experts)
-+    logging.basicConfig(level=args.logger_level)
- 
--    n_experts = 1
-+    # Set a random seed used in ChainerRL
-+    misc.set_random_seed(args.seed, gpus=(args.gpu,))
- 
--    demo_states = []
--    demo_actions = []
-+    if not (args.demo and args.load):
-+        args.outdir = experiments.prepare_output_dir(args, args.outdir)
- 
--    for i in range(n_experts):
--        usr = User(time_steps = 128)
--        states, actions = usr.generate_trajectory()
--        demo_states.append(states)
--        demo_actions.append(actions)
-+    def make_env(test):
-+        env = gym.make(args.env)
-+        env.define_case(0, 0, 7*[0])
- 
--    PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--    np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--             actions=np.array(demo_actions, dtype=object)) 
--    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--    s = subprocess.Popen(command)
-+        # Use different random seeds for train and test envs
-+        env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
-+        env.seed(env_seed)
-+        # Cast observations to float32 because our model uses float32
-+        env = chainerrl.wrappers.CastObservationToFloat32(env)
-+        if args.monitor:
-+            env = gym.wrappers.Monitor(env, args.outdir)
-+        if not test:
-+            # Scale rewards (and thus returns) to a reasonable range so that
-+            # training is easier
-+            env = chainerrl.wrappers.ScaleReward(env, args.reward_scale_factor)
-+        if args.render:
-+            env = chainerrl.wrappers.Render(env)
-+        return env
- 
--def find_env(case, n_experts):
--    if case == 'discrete_events':
--        if n_experts == 1:
--            env = 'discrete-buying-events-v0'
-+    sample_env = gym.make(args.env)
-+    sample_env.define_case(0, 0, 7*[0])
-+    timestep_limit = sample_env.spec.tags.get(
-+        'wrapper_config.TimeLimit.max_episode_steps')
-+    obs_space = sample_env.observation_space
-+    action_space = sample_env.action_space
- 
--    if case == 'full_receipt':
--        if n_experts == 1:
--            env = ''
-+    # Normalize observations based on their empirical mean and variance
- 
--    return env
-+    obs_normalizer = None                                                                # HarDKODAT
-+    #chainerrl.links.EmpiricalNormalization(obs_space.low.size, clip_threshold=5)
-+
-+    # Switch policy types accordingly to action space types
-+    if args.arch == 'FFSoftmax':
-+        model = A3CFFSoftmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFMellowmax':
-+        model = A3CFFMellowmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFGaussian':
-+        model = A3CFFGaussian(obs_space.low.size, action_space,
-+                              bound_mean=args.bound_mean)
-+
-+    opt = chainer.optimizers.Adam(alpha=args.lr, eps=1e-5)
-+    opt.setup(model)
-+    if args.weight_decay > 0:
-+        opt.add_hook(NonbiasWeightDecay(args.weight_decay))
-+    if args.algo == 'ppo':
-+        agent = PPO(model, opt,
-+                    obs_normalizer=obs_normalizer,
-+                    gpu=args.gpu,
-+                    update_interval=args.update_interval,
-+                    minibatch_size=args.batchsize, epochs=args.epochs,
-+                    clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                    standardize_advantages=args.standardize_advantages,
-+                    )
-+    elif args.algo == 'gail':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.gail import GAIL
-+        from customer_behaviour.algorithms.irl.gail import Discriminator
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = GAIL(demonstrations=demonstrations, discriminator=D,
-+                     model=model, optimizer=opt,
-+                     obs_normalizer=obs_normalizer,
-+                     gpu=args.gpu,
-+                     update_interval=args.update_interval,
-+                     minibatch_size=args.batchsize, epochs=args.epochs,
-+                     clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                     standardize_advantages=args.standardize_advantages,)
-+    elif args.algo == 'airl':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.airl import AIRL as Agent
-+        from customer_behaviour.algorithms.irl.airl import Discriminator
-+        # obs_normalizer = None
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = Agent(demonstrations=demonstrations, discriminator=D,
-+                      model=model, optimizer=opt,
-+                      obs_normalizer=obs_normalizer,
-+                      gpu=args.gpu,
-+                      update_interval=args.update_interval,
-+                      minibatch_size=args.batchsize, epochs=args.epochs,
-+                      clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                      standardize_advantages=args.standardize_advantages,)
-+
-+    if args.load:
-+        agent.load(args.load)
-+
-+    if args.demo:
-+        env = make_env(True)
-+        eval_stats = experiments.eval_performance(
-+            env=env,
-+            agent=agent,
-+            n_steps=None,
-+            n_episodes=args.eval_n_runs,
-+            max_episode_len=timestep_limit)
-+        print('n_runs: {} mean: {} median: {} stdev {}'.format(
-+            args.eval_n_runs, eval_stats['mean'], eval_stats['median'],
-+            eval_stats['stdev']))
-+        outdir = args.load if args.load else args.outdir
-+        save_agent_demo(make_env(False), agent, outdir)
-+    else:
-+        # Linearly decay the learning rate to zero
-+        def lr_setter(env, agent, value):
-+            agent.optimizer.alpha = value
-+
-+        lr_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, args.lr, 0, lr_setter)
-+
-+        # Linearly decay the clipping parameter to zero
-+        def clip_eps_setter(env, agent, value):
-+            agent.clip_eps = max(value, 1e-8)
-+
-+        clip_eps_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, 0.2, 0, clip_eps_setter)
-+
-+        experiments.train_agent_with_evaluation(
-+            agent=agent,
-+            env=make_env(False),
-+            eval_env=make_env(True),
-+            outdir=args.outdir,
-+            steps=args.steps,
-+            eval_n_steps=None,
-+            eval_n_episodes=args.eval_n_runs,
-+            eval_interval=args.eval_interval,
-+            train_max_episode_len=timestep_limit,
-+            save_best_so_far_agent=False,
-+            step_hooks=[
-+                lr_decay_hook,
-+                clip_eps_decay_hook,
-+            ],
-+        )
-+        save_agent_demo(make_env(False), agent, args.outdir)
- 
- 
- if __name__ == '__main__':
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-head.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-head.txt
deleted file mode 100644
index ed95f27..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-head.txt
+++ /dev/null
@@ -1 +0,0 @@
-92fa4b893bc749ddaa3a3d107d383d7ad35748f5
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-log.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-log.txt
deleted file mode 100644
index a91c7dc..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-log.txt
+++ /dev/null
@@ -1,211 +0,0 @@
-commit 92fa4b893bc749ddaa3a3d107d383d7ad35748f5
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Mon Feb 10 08:44:27 2020 +0100
-
-    kfj
-
-commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 15:08:07 2020 +0100
-
-    updated main
-
-commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:57:39 2020 +0100
-
-    main hej
-
-commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
-Merge: 551fe5f 8737870
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:50:41 2020 +0100
-
-    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
-
-commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:47:48 2020 +0100
-
-    fixed main
-
-commit 8737870c484cb6b62516b732984a5a89d49758c9
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 14:44:23 2020 +0100
-
-    added fcn define_case()
-
-commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 13:22:18 2020 +0100
-
-    hej
-
-commit 989a9ddbce8c70f8884960c940dff5cb85abe953
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 17:12:55 2020 +0100
-
-    bra skit
-
-commit fcf59768c112e2f710499a11a083ddbf926e90f1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:57:23 2020 +0100
-
-    fixed main
-
-commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:36:26 2020 +0100
-
-    installed configparser, created config.ini and main.py
-
-commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:23:36 2020 +0100
-
-    changed name of folders
-
-commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 15:48:33 2020 +0100
-
-    changed structure, added __init.py files
-
-commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:11:39 2020 +0100
-
-    changed structure
-
-commit 28daae8a8544c14b37f99e8726991791996ad55a
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:09:29 2020 +0100
-
-    Changed structure of repo
-
-commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 13:05:51 2020 +0100
-
-    updated code to get GAIL to run
-
-commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 10:41:03 2020 +0100
-
-    added results
-
-commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:56:40 2020 +0100
-
-    fin
-
-commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:43:09 2020 +0100
-
-    hgi
-
-commit faf34d5f495f4f5424279e5823d168af86fd7291
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:38:52 2020 +0100
-
-    fixed requirements.txt
-
-commit d0bbd5cabbc023ddc00945620543c56372367146
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:08:25 2020 +0100
-
-    added deepirl
-
-commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:06:32 2020 +0100
-
-    fixni
-
-commit 13215698e0d7d48d404df1075c540037bc470a59
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:00:49 2020 +0100
-
-    added files for custom_env
-
-commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 16:09:26 2020 +0100
-
-    fixed .npz file
-
-commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Tue Feb 4 16:08:32 2020 +0100
-
-    created env
-
-commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:54:48 2020 +0100
-
-    added traj
-
-commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
-Merge: 89e455b 585fa30
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:39:11 2020 +0100
-
-    gij
-
-commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:38:22 2020 +0100
-
-    gg
-
-commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:36:44 2020 +0100
-
-    changed in user class
-
-commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:19 2020 +0100
-
-    Delete gail_pendulum.zip
-
-commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:10 2020 +0100
-
-    Delete expert_pendulum.npz
-
-commit 5d83000b84635f517ffd723a2f47424e75a16f80
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 16:30:13 2020 +0100
-
-    feature extraction + plots changed
-
-commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 11:57:18 2020 +0100
-
-    added generate_data.py
-
-commit 216496211fab6141cd7fcc891228f8692350a3ff
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 08:41:26 2020 +0100
-
-    Tested different ways to compare time series
-
-commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Jan 21 15:17:48 2020 +0100
-
-    first commit
-
-commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Jan 20 09:53:42 2020 +0100
-
-    Initial commit
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-status.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-status.txt
deleted file mode 100644
index bba909f..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/git-status.txt
+++ /dev/null
@@ -1,30 +0,0 @@
-On branch master
-Your branch is up to date with 'origin/master'.
-
-Changes not staged for commit:
-  (use "git add/rm <file>..." to update what will be committed)
-  (use "git checkout -- <file>..." to discard changes in working directory)
-
-	deleted:    config.ini
-	modified:   customer_behaviour/algorithms/irl/airl/discriminator.py
-	modified:   customer_behaviour/algorithms/irl/common/utils/__init__.py
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-	modified:   temp_main.py
-
-Untracked files:
-  (use "git add <file>..." to include in what will be committed)
-
-	results/airl/
-	results/gail/
-
-no changes added to commit (use "git add" and/or "git commit -a")
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/scores.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/scores.txt
deleted file mode 100644
index 3f8062a..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/scores.txt
+++ /dev/null
@@ -1 +0,0 @@
-steps	episodes	elapsed	mean	median	stdev	max	min	average_value	average_entropy	average_value_loss	average_policy_loss
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/trajectories.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/trajectories.npz
deleted file mode 100644
index fc48d49..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-19-39/20200210T091939.549958/trajectories.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/10_finish/model.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/10_finish/model.npz
deleted file mode 100644
index 6d7f2be..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/10_finish/model.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/10_finish/optimizer.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/10_finish/optimizer.npz
deleted file mode 100644
index eecd553..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/10_finish/optimizer.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/args.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/args.txt
deleted file mode 100644
index 46330cb..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/args.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"algo": "gail", "gpu": -1, "case": "discrete_events", "n_experts": 1, "n_categories": 1, "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01, "outdir": "results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16", "env": "discrete-buying-events-v0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/command.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/command.txt
deleted file mode 100644
index 2b0c892..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/command.txt
+++ /dev/null
@@ -1 +0,0 @@
-temp_main.py gail --gpu -1 --case discrete_events --n_experts 1 --n_categories 1 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/environ.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/environ.txt
deleted file mode 100644
index 9c1bbd9..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/environ.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"TERM_PROGRAM": "Apple_Terminal", "TERM": "xterm-256color", "SHELL": "/bin/bash", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.gjMnJvQ4ux/Render", "TERM_PROGRAM_VERSION": "421.2", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.4I4GqXIb2y/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "HOME": "/Users/victor", "SHLVL": "1", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-diff.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-diff.txt
deleted file mode 100644
index decbde1..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-diff.txt
+++ /dev/null
@@ -1,709 +0,0 @@
-diff --git a/config.ini b/config.ini
-deleted file mode 100644
-index 0b70f3c..0000000
---- a/config.ini
-+++ /dev/null
-@@ -1,11 +0,0 @@
--[DEFAULT]
--
--
--[discrete_events]
--N_EXPERTS = 1
--N_PRODUCTS = 1
--
--[full_receipts]
--N_EXPERTS = 1
--N_PRODUCTS = 6
--
-diff --git a/customer_behaviour/algorithms/irl/airl/discriminator.py b/customer_behaviour/algorithms/irl/airl/discriminator.py
-index 931e98e..cdc5c9d 100755
---- a/customer_behaviour/algorithms/irl/airl/discriminator.py
-+++ b/customer_behaviour/algorithms/irl/airl/discriminator.py
-@@ -1,6 +1,6 @@
- import chainer
- import chainer.functions as F
--from irl.common.model import MLP
-+from customer_behaviour.algorithms.irl.common.model import MLP
- from chainer.link_hooks.spectral_normalization import SpectralNormalization
- 
- 
-diff --git a/customer_behaviour/algorithms/irl/common/utils/__init__.py b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-index f808b8c..2c9d8c4 100755
---- a/customer_behaviour/algorithms/irl/common/utils/__init__.py
-+++ b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-@@ -1 +1 @@
--from irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-+from customer_behaviour.algorithms.irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-deleted file mode 100644
-index f0dec34..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-deleted file mode 100644
-index eecd553..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-deleted file mode 100644
-index c122e59..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"algo": "airl", "gpu": -1, "env": "discrete-buying-events-v0", "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "outdir": "results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43", "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-deleted file mode 100644
-index 913e5b6..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--customer_behaviour/algorithms/train_gym.py airl --gpu -1 --env discrete-buying-events-v0 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01 --outdir results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-deleted file mode 100644
-index ef43d43..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"TERM_PROGRAM": "Apple_Terminal", "SHELL": "/bin/bash", "TERM": "xterm-256color", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.JuAPseFAEM/Render", "TERM_PROGRAM_VERSION": "421.2", "OLDPWD": "/Users/victor/Documents/CAS_2/Master_thesis", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.b16K4t4cKk/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "SHLVL": "1", "HOME": "/Users/victor", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-deleted file mode 100644
-index 341b94d..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-+++ /dev/null
-@@ -1,30 +0,0 @@
--diff --git a/expert_trajectories.npz b/expert_trajectories.npz
--index 6fd7b82..04a5abf 100644
--Binary files a/expert_trajectories.npz and b/expert_trajectories.npz differ
--diff --git a/main.py b/main.py
--index 60a144f..adf5222 100644
----- a/main.py
--+++ b/main.py
--@@ -19,12 +19,10 @@ def main(case = 'discrete_events'):
-- 
--     outdir = get_outdir(args.case, args.n_experts, n_categories=1)
-- 
---    n_experts = 1
---
--     demo_states = []
--     demo_actions = []
-- 
---    for i in range(n_experts):
--+    for i in range(args.n_experts):
--         usr = User(time_steps = 128)
--         states, actions = usr.generate_trajectory()
--         demo_states.append(states)
--@@ -33,7 +31,7 @@ def main(case = 'discrete_events'):
--     PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--     np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--              actions=np.array(demo_actions, dtype=object)) 
---    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--+    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01', '--outdir', outdir]
--     s = subprocess.Popen(command)
-- 
-- 
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-deleted file mode 100644
-index c32b34f..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-deleted file mode 100644
-index 4286080..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-+++ /dev/null
-@@ -1,205 +0,0 @@
--commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 15:08:07 2020 +0100
--
--    updated main
--
--commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:57:39 2020 +0100
--
--    main hej
--
--commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
--Merge: 551fe5f 8737870
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:50:41 2020 +0100
--
--    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
--
--commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:47:48 2020 +0100
--
--    fixed main
--
--commit 8737870c484cb6b62516b732984a5a89d49758c9
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 14:44:23 2020 +0100
--
--    added fcn define_case()
--
--commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 13:22:18 2020 +0100
--
--    hej
--
--commit 989a9ddbce8c70f8884960c940dff5cb85abe953
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 17:12:55 2020 +0100
--
--    bra skit
--
--commit fcf59768c112e2f710499a11a083ddbf926e90f1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:57:23 2020 +0100
--
--    fixed main
--
--commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:36:26 2020 +0100
--
--    installed configparser, created config.ini and main.py
--
--commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:23:36 2020 +0100
--
--    changed name of folders
--
--commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 15:48:33 2020 +0100
--
--    changed structure, added __init.py files
--
--commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:11:39 2020 +0100
--
--    changed structure
--
--commit 28daae8a8544c14b37f99e8726991791996ad55a
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:09:29 2020 +0100
--
--    Changed structure of repo
--
--commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 13:05:51 2020 +0100
--
--    updated code to get GAIL to run
--
--commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 10:41:03 2020 +0100
--
--    added results
--
--commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:56:40 2020 +0100
--
--    fin
--
--commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:43:09 2020 +0100
--
--    hgi
--
--commit faf34d5f495f4f5424279e5823d168af86fd7291
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:38:52 2020 +0100
--
--    fixed requirements.txt
--
--commit d0bbd5cabbc023ddc00945620543c56372367146
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:08:25 2020 +0100
--
--    added deepirl
--
--commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:06:32 2020 +0100
--
--    fixni
--
--commit 13215698e0d7d48d404df1075c540037bc470a59
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:00:49 2020 +0100
--
--    added files for custom_env
--
--commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 16:09:26 2020 +0100
--
--    fixed .npz file
--
--commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Tue Feb 4 16:08:32 2020 +0100
--
--    created env
--
--commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:54:48 2020 +0100
--
--    added traj
--
--commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
--Merge: 89e455b 585fa30
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:39:11 2020 +0100
--
--    gij
--
--commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:38:22 2020 +0100
--
--    gg
--
--commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:36:44 2020 +0100
--
--    changed in user class
--
--commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:19 2020 +0100
--
--    Delete gail_pendulum.zip
--
--commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:10 2020 +0100
--
--    Delete expert_pendulum.npz
--
--commit 5d83000b84635f517ffd723a2f47424e75a16f80
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 16:30:13 2020 +0100
--
--    feature extraction + plots changed
--
--commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 11:57:18 2020 +0100
--
--    added generate_data.py
--
--commit 216496211fab6141cd7fcc891228f8692350a3ff
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 08:41:26 2020 +0100
--
--    Tested different ways to compare time series
--
--commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Jan 21 15:17:48 2020 +0100
--
--    first commit
--
--commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Jan 20 09:53:42 2020 +0100
--
--    Initial commit
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-deleted file mode 100644
-index 953dca0..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-+++ /dev/null
-@@ -1,16 +0,0 @@
--On branch master
--Your branch is up to date with 'origin/master'.
--
--Changes not staged for commit:
--  (use "git add <file>..." to update what will be committed)
--  (use "git checkout -- <file>..." to discard changes in working directory)
--
--	modified:   expert_trajectories.npz
--	modified:   main.py
--
--Untracked files:
--  (use "git add <file>..." to include in what will be committed)
--
--	results/discrete_events/
--
--no changes added to commit (use "git add" and/or "git commit -a")
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-deleted file mode 100644
-index 99dfa5e..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-deleted file mode 100644
-index fc48d49..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz and /dev/null differ
-diff --git a/temp_main.py b/temp_main.py
-index a507968..6e5bc93 100644
---- a/temp_main.py
-+++ b/temp_main.py
-@@ -1,47 +1,318 @@
--from customer_behaviour.tools import dgm as dgm
--from customer_behaviour.tools.generate_data import User 
-+"""An example of training PPO against OpenAI Gym Envs.
-+
-+This script is an example of training a PPO agent against OpenAI Gym envs.
-+Both discrete and continuous action spaces are supported.
-+
-+To solve CartPole-v0, run:
-+    python train_ppo_gym.py --env CartPole-v0
-+"""
-+
-+import sys
- import os
-+import datetime
- import argparse
--import subprocess
--import numpy as np
-+from os.path import join
-+#sys.path.append(os.getcwd())
-+
-+
-+import gym
-+import custom_gym
-+import gym.wrappers
-+
-+import chainer
-+from chainer import functions as F
-+import chainerrl
-+
-+from chainerrl.agents import a3c
-+from chainerrl.agents import PPO
-+from chainerrl import experiments
-+from chainerrl import links
-+from chainerrl import misc
-+from chainerrl.optimizers.nonbias_weight_decay import NonbiasWeightDecay
-+from chainerrl import policies
-+
-+
-+class A3CFFSoftmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward softmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.SoftmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFMellowmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward mellowmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.MellowmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFGaussian(chainer.Chain, a3c.A3CModel):
-+    """An example of A3C feedforward Gaussian policy."""
-+
-+    def __init__(self, obs_size, action_space,
-+                 n_hidden_layers=2, n_hidden_channels=64,
-+                 bound_mean=None):
-+        assert bound_mean in [False, True]
-+        super().__init__()
-+        hidden_sizes = (n_hidden_channels,) * n_hidden_layers
-+        with self.init_scope():
-+            self.pi = policies.FCGaussianPolicyWithStateIndependentCovariance(
-+                obs_size, action_space.low.size,
-+                n_hidden_layers, n_hidden_channels,
-+                var_type='diagonal', nonlinearity=F.tanh,
-+                bound_mean=bound_mean,
-+                min_action=action_space.low, max_action=action_space.high,
-+                mean_wscale=1e-2)
-+            self.v = links.MLP(obs_size, 1, hidden_sizes=hidden_sizes)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+def save_agent_demo(env, agent, out_dir, max_t=2000):
-+    import numpy as np
-+    r, t = 0, 0
-+    agent_observations = []
-+    agent_actions = []
-+    while t < max_t:
-+        agent_observations.append([])
-+        agent_actions.append([])
-+        obs = env.reset()
-+        while True:
-+            act = agent.act(obs)
-+            agent_observations[-1].append(obs)
-+            agent_actions[-1].append(act)
-+            obs, reward, done, _ = env.step(act)
-+            t += 1
-+            r += reward
-+            if done or t >= max_t:
-+                print(t)
-+                break
-+
-+    # save numpy array consists of lists
-+    np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
-+             actions=np.array(agent_actions, dtype=object))
-+
-+def get_outdir(algo, case, n_experts, n_categories):
-+
-+    if not os.path.exists('results'): os.makedirs('results')
-+
-+    path = join('results', str(algo))
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, case)
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_experts) + '_expert(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_categories) + '_product(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-+    path = join(path, time)
-+
-+    return path
-+
-+
-+def get_env(case, n_experts):
-+    if case == 'discrete_events':
-+        env = 'discrete-buying-events-v0'
-+    elif case == 'full_receipt':
-+        env = ''
-+
-+    return env
-+
-+
-+def main():
-+    import logging
- 
--def main(case = 'discrete_events'):
-     parser = argparse.ArgumentParser()
-     parser.add_argument('algo', default='gail', choices=['gail', 'airl'], type=str)
--    parser.add_argument('--case', type=str, default=case)
-+    parser.add_argument('--gpu', type=int, default=0)
-+    parser.add_argument('--case', type=str, default='discrete_events')
-     parser.add_argument('--n_experts', type=int, default=1)
--    parser.add_argument('--n_steps', type=int, default=10000)
-+    parser.add_argument('--n_categories', type=int, default=1)
-+    parser.add_argument('--arch', type=str, default='FFGaussian',
-+                        choices=('FFSoftmax', 'FFMellowmax',
-+                                 'FFGaussian'))
-+    parser.add_argument('--bound-mean', action='store_true')
-+    parser.add_argument('--seed', type=int, default=0,
-+                        help='Random seed [0, 2 ** 32)')
-+    #parser.add_argument('--outdir', type=str, default='results', help='Directory path to save output files.'' If it does not exist, it will be created.')
-+    parser.add_argument('--steps', type=int, default=10 ** 6)
-+    parser.add_argument('--eval-interval', type=int, default=10000)
-+    parser.add_argument('--eval-n-runs', type=int, default=10)
-+    parser.add_argument('--reward-scale-factor', type=float, default=1e-2)
-+    parser.add_argument('--standardize-advantages', action='store_true')
-+    parser.add_argument('--render', action='store_true', default=False)
-+    parser.add_argument('--lr', type=float, default=3e-4)
-+    parser.add_argument('--weight-decay', type=float, default=0.0)
-+    parser.add_argument('--demo', action='store_true', default=False)
-+    parser.add_argument('--load', type=str, default='')
-+    parser.add_argument('--load_demo', type=str, default='')
-+    parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
-+    parser.add_argument('--monitor', action='store_true')
-+
-+    parser.add_argument('--update-interval', type=int, default=2048)
-+    parser.add_argument('--batchsize', type=int, default=64)
-+    parser.add_argument('--epochs', type=int, default=10)
-+    parser.add_argument('--entropy-coef', type=float, default=0.0)
-     args = parser.parse_args()
-+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-+    args.env = get_env(args.case, args.n_experts)
- 
--    env = find_env(args.case, args.n_experts)
-+    logging.basicConfig(level=args.logger_level)
- 
--    n_experts = 1
-+    # Set a random seed used in ChainerRL
-+    misc.set_random_seed(args.seed, gpus=(args.gpu,))
- 
--    demo_states = []
--    demo_actions = []
-+    if not (args.demo and args.load):
-+        args.outdir = experiments.prepare_output_dir(args, args.outdir)
- 
--    for i in range(n_experts):
--        usr = User(time_steps = 128)
--        states, actions = usr.generate_trajectory()
--        demo_states.append(states)
--        demo_actions.append(actions)
-+    def make_env(test):
-+        env = gym.make(args.env)
-+        env.define_case(0, 0, 7*[0])
- 
--    PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--    np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--             actions=np.array(demo_actions, dtype=object)) 
--    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--    s = subprocess.Popen(command)
-+        # Use different random seeds for train and test envs
-+        env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
-+        env.seed(env_seed)
-+        # Cast observations to float32 because our model uses float32
-+        env = chainerrl.wrappers.CastObservationToFloat32(env)
-+        if args.monitor:
-+            env = gym.wrappers.Monitor(env, args.outdir)
-+        if not test:
-+            # Scale rewards (and thus returns) to a reasonable range so that
-+            # training is easier
-+            env = chainerrl.wrappers.ScaleReward(env, args.reward_scale_factor)
-+        if args.render:
-+            env = chainerrl.wrappers.Render(env)
-+        return env
- 
--def find_env(case, n_experts):
--    if case == 'discrete_events':
--        if n_experts == 1:
--            env = 'discrete-buying-events-v0'
-+    sample_env = gym.make(args.env)
-+    sample_env.define_case(0, 0, 7*[0])
-+    timestep_limit = sample_env.spec.tags.get(
-+        'wrapper_config.TimeLimit.max_episode_steps')
-+    obs_space = sample_env.observation_space
-+    action_space = sample_env.action_space
- 
--    if case == 'full_receipt':
--        if n_experts == 1:
--            env = ''
-+    # Normalize observations based on their empirical mean and variance
- 
--    return env
-+    obs_normalizer = None                                                                # HarDKODAT
-+    #chainerrl.links.EmpiricalNormalization(obs_space.low.size, clip_threshold=5)
-+
-+    # Switch policy types accordingly to action space types
-+    if args.arch == 'FFSoftmax':
-+        model = A3CFFSoftmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFMellowmax':
-+        model = A3CFFMellowmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFGaussian':
-+        model = A3CFFGaussian(obs_space.low.size, action_space,
-+                              bound_mean=args.bound_mean)
-+
-+    opt = chainer.optimizers.Adam(alpha=args.lr, eps=1e-5)
-+    opt.setup(model)
-+    if args.weight_decay > 0:
-+        opt.add_hook(NonbiasWeightDecay(args.weight_decay))
-+    if args.algo == 'ppo':
-+        agent = PPO(model, opt,
-+                    obs_normalizer=obs_normalizer,
-+                    gpu=args.gpu,
-+                    update_interval=args.update_interval,
-+                    minibatch_size=args.batchsize, epochs=args.epochs,
-+                    clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                    standardize_advantages=args.standardize_advantages,
-+                    )
-+    elif args.algo == 'gail':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.gail import GAIL
-+        from customer_behaviour.algorithms.irl.gail import Discriminator
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = GAIL(demonstrations=demonstrations, discriminator=D,
-+                     model=model, optimizer=opt,
-+                     obs_normalizer=obs_normalizer,
-+                     gpu=args.gpu,
-+                     update_interval=args.update_interval,
-+                     minibatch_size=args.batchsize, epochs=args.epochs,
-+                     clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                     standardize_advantages=args.standardize_advantages,)
-+    elif args.algo == 'airl':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.airl import AIRL as Agent
-+        from customer_behaviour.algorithms.irl.airl import Discriminator
-+        # obs_normalizer = None
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = Agent(demonstrations=demonstrations, discriminator=D,
-+                      model=model, optimizer=opt,
-+                      obs_normalizer=obs_normalizer,
-+                      gpu=args.gpu,
-+                      update_interval=args.update_interval,
-+                      minibatch_size=args.batchsize, epochs=args.epochs,
-+                      clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                      standardize_advantages=args.standardize_advantages,)
-+
-+    if args.load:
-+        agent.load(args.load)
-+
-+    if args.demo:
-+        env = make_env(True)
-+        eval_stats = experiments.eval_performance(
-+            env=env,
-+            agent=agent,
-+            n_steps=None,
-+            n_episodes=args.eval_n_runs,
-+            max_episode_len=timestep_limit)
-+        print('n_runs: {} mean: {} median: {} stdev {}'.format(
-+            args.eval_n_runs, eval_stats['mean'], eval_stats['median'],
-+            eval_stats['stdev']))
-+        outdir = args.load if args.load else args.outdir
-+        save_agent_demo(make_env(False), agent, outdir)
-+    else:
-+        # Linearly decay the learning rate to zero
-+        def lr_setter(env, agent, value):
-+            agent.optimizer.alpha = value
-+
-+        lr_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, args.lr, 0, lr_setter)
-+
-+        # Linearly decay the clipping parameter to zero
-+        def clip_eps_setter(env, agent, value):
-+            agent.clip_eps = max(value, 1e-8)
-+
-+        clip_eps_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, 0.2, 0, clip_eps_setter)
-+
-+        experiments.train_agent_with_evaluation(
-+            agent=agent,
-+            env=make_env(False),
-+            eval_env=make_env(True),
-+            outdir=args.outdir,
-+            steps=args.steps,
-+            eval_n_steps=None,
-+            eval_n_episodes=args.eval_n_runs,
-+            eval_interval=args.eval_interval,
-+            train_max_episode_len=timestep_limit,
-+            save_best_so_far_agent=False,
-+            step_hooks=[
-+                lr_decay_hook,
-+                clip_eps_decay_hook,
-+            ],
-+        )
-+        save_agent_demo(make_env(False), agent, args.outdir)
- 
- 
- if __name__ == '__main__':
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-head.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-head.txt
deleted file mode 100644
index ed95f27..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-head.txt
+++ /dev/null
@@ -1 +0,0 @@
-92fa4b893bc749ddaa3a3d107d383d7ad35748f5
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-log.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-log.txt
deleted file mode 100644
index a91c7dc..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-log.txt
+++ /dev/null
@@ -1,211 +0,0 @@
-commit 92fa4b893bc749ddaa3a3d107d383d7ad35748f5
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Mon Feb 10 08:44:27 2020 +0100
-
-    kfj
-
-commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 15:08:07 2020 +0100
-
-    updated main
-
-commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:57:39 2020 +0100
-
-    main hej
-
-commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
-Merge: 551fe5f 8737870
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:50:41 2020 +0100
-
-    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
-
-commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:47:48 2020 +0100
-
-    fixed main
-
-commit 8737870c484cb6b62516b732984a5a89d49758c9
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 14:44:23 2020 +0100
-
-    added fcn define_case()
-
-commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 13:22:18 2020 +0100
-
-    hej
-
-commit 989a9ddbce8c70f8884960c940dff5cb85abe953
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 17:12:55 2020 +0100
-
-    bra skit
-
-commit fcf59768c112e2f710499a11a083ddbf926e90f1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:57:23 2020 +0100
-
-    fixed main
-
-commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:36:26 2020 +0100
-
-    installed configparser, created config.ini and main.py
-
-commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:23:36 2020 +0100
-
-    changed name of folders
-
-commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 15:48:33 2020 +0100
-
-    changed structure, added __init.py files
-
-commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:11:39 2020 +0100
-
-    changed structure
-
-commit 28daae8a8544c14b37f99e8726991791996ad55a
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:09:29 2020 +0100
-
-    Changed structure of repo
-
-commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 13:05:51 2020 +0100
-
-    updated code to get GAIL to run
-
-commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 10:41:03 2020 +0100
-
-    added results
-
-commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:56:40 2020 +0100
-
-    fin
-
-commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:43:09 2020 +0100
-
-    hgi
-
-commit faf34d5f495f4f5424279e5823d168af86fd7291
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:38:52 2020 +0100
-
-    fixed requirements.txt
-
-commit d0bbd5cabbc023ddc00945620543c56372367146
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:08:25 2020 +0100
-
-    added deepirl
-
-commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:06:32 2020 +0100
-
-    fixni
-
-commit 13215698e0d7d48d404df1075c540037bc470a59
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:00:49 2020 +0100
-
-    added files for custom_env
-
-commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 16:09:26 2020 +0100
-
-    fixed .npz file
-
-commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Tue Feb 4 16:08:32 2020 +0100
-
-    created env
-
-commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:54:48 2020 +0100
-
-    added traj
-
-commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
-Merge: 89e455b 585fa30
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:39:11 2020 +0100
-
-    gij
-
-commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:38:22 2020 +0100
-
-    gg
-
-commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:36:44 2020 +0100
-
-    changed in user class
-
-commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:19 2020 +0100
-
-    Delete gail_pendulum.zip
-
-commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:10 2020 +0100
-
-    Delete expert_pendulum.npz
-
-commit 5d83000b84635f517ffd723a2f47424e75a16f80
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 16:30:13 2020 +0100
-
-    feature extraction + plots changed
-
-commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 11:57:18 2020 +0100
-
-    added generate_data.py
-
-commit 216496211fab6141cd7fcc891228f8692350a3ff
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 08:41:26 2020 +0100
-
-    Tested different ways to compare time series
-
-commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Jan 21 15:17:48 2020 +0100
-
-    first commit
-
-commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Jan 20 09:53:42 2020 +0100
-
-    Initial commit
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-status.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-status.txt
deleted file mode 100644
index bba909f..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/git-status.txt
+++ /dev/null
@@ -1,30 +0,0 @@
-On branch master
-Your branch is up to date with 'origin/master'.
-
-Changes not staged for commit:
-  (use "git add/rm <file>..." to update what will be committed)
-  (use "git checkout -- <file>..." to discard changes in working directory)
-
-	deleted:    config.ini
-	modified:   customer_behaviour/algorithms/irl/airl/discriminator.py
-	modified:   customer_behaviour/algorithms/irl/common/utils/__init__.py
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-	modified:   temp_main.py
-
-Untracked files:
-  (use "git add <file>..." to include in what will be committed)
-
-	results/airl/
-	results/gail/
-
-no changes added to commit (use "git add" and/or "git commit -a")
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/scores.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/scores.txt
deleted file mode 100644
index 3f8062a..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/scores.txt
+++ /dev/null
@@ -1 +0,0 @@
-steps	episodes	elapsed	mean	median	stdev	max	min	average_value	average_entropy	average_value_loss	average_policy_loss
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/trajectories.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/trajectories.npz
deleted file mode 100644
index fc48d49..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-25-16/20200210T092516.961007/trajectories.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/args.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/args.txt
deleted file mode 100644
index 8e0dc71..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/args.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"algo": "gail", "gpu": -1, "case": "discrete_events", "n_experts": 1, "n_categories": 1, "seed_expert": false, "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01, "outdir": "results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00", "env": "discrete-buying-events-v0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/command.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/command.txt
deleted file mode 100644
index 4830419..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/command.txt
+++ /dev/null
@@ -1 +0,0 @@
-temp_main.py gail --gpu -1 --case discrete_events --n_experts 1 --n_categories 1 --steps 10 --seed_expert False
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/environ.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/environ.txt
deleted file mode 100644
index 9c1bbd9..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/environ.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"TERM_PROGRAM": "Apple_Terminal", "TERM": "xterm-256color", "SHELL": "/bin/bash", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.gjMnJvQ4ux/Render", "TERM_PROGRAM_VERSION": "421.2", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.4I4GqXIb2y/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "HOME": "/Users/victor", "SHLVL": "1", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-diff.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-diff.txt
deleted file mode 100644
index 3cf6ea9..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-diff.txt
+++ /dev/null
@@ -1,722 +0,0 @@
-diff --git a/config.ini b/config.ini
-deleted file mode 100644
-index 0b70f3c..0000000
---- a/config.ini
-+++ /dev/null
-@@ -1,11 +0,0 @@
--[DEFAULT]
--
--
--[discrete_events]
--N_EXPERTS = 1
--N_PRODUCTS = 1
--
--[full_receipts]
--N_EXPERTS = 1
--N_PRODUCTS = 6
--
-diff --git a/customer_behaviour/algorithms/irl/airl/discriminator.py b/customer_behaviour/algorithms/irl/airl/discriminator.py
-index 931e98e..cdc5c9d 100755
---- a/customer_behaviour/algorithms/irl/airl/discriminator.py
-+++ b/customer_behaviour/algorithms/irl/airl/discriminator.py
-@@ -1,6 +1,6 @@
- import chainer
- import chainer.functions as F
--from irl.common.model import MLP
-+from customer_behaviour.algorithms.irl.common.model import MLP
- from chainer.link_hooks.spectral_normalization import SpectralNormalization
- 
- 
-diff --git a/customer_behaviour/algorithms/irl/common/utils/__init__.py b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-index f808b8c..2c9d8c4 100755
---- a/customer_behaviour/algorithms/irl/common/utils/__init__.py
-+++ b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-@@ -1 +1 @@
--from irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-+from customer_behaviour.algorithms.irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-deleted file mode 100644
-index f0dec34..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-deleted file mode 100644
-index eecd553..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-deleted file mode 100644
-index c122e59..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"algo": "airl", "gpu": -1, "env": "discrete-buying-events-v0", "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "outdir": "results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43", "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-deleted file mode 100644
-index 913e5b6..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--customer_behaviour/algorithms/train_gym.py airl --gpu -1 --env discrete-buying-events-v0 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01 --outdir results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-deleted file mode 100644
-index ef43d43..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"TERM_PROGRAM": "Apple_Terminal", "SHELL": "/bin/bash", "TERM": "xterm-256color", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.JuAPseFAEM/Render", "TERM_PROGRAM_VERSION": "421.2", "OLDPWD": "/Users/victor/Documents/CAS_2/Master_thesis", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.b16K4t4cKk/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "SHLVL": "1", "HOME": "/Users/victor", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-deleted file mode 100644
-index 341b94d..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-+++ /dev/null
-@@ -1,30 +0,0 @@
--diff --git a/expert_trajectories.npz b/expert_trajectories.npz
--index 6fd7b82..04a5abf 100644
--Binary files a/expert_trajectories.npz and b/expert_trajectories.npz differ
--diff --git a/main.py b/main.py
--index 60a144f..adf5222 100644
----- a/main.py
--+++ b/main.py
--@@ -19,12 +19,10 @@ def main(case = 'discrete_events'):
-- 
--     outdir = get_outdir(args.case, args.n_experts, n_categories=1)
-- 
---    n_experts = 1
---
--     demo_states = []
--     demo_actions = []
-- 
---    for i in range(n_experts):
--+    for i in range(args.n_experts):
--         usr = User(time_steps = 128)
--         states, actions = usr.generate_trajectory()
--         demo_states.append(states)
--@@ -33,7 +31,7 @@ def main(case = 'discrete_events'):
--     PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--     np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--              actions=np.array(demo_actions, dtype=object)) 
---    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--+    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01', '--outdir', outdir]
--     s = subprocess.Popen(command)
-- 
-- 
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-deleted file mode 100644
-index c32b34f..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-deleted file mode 100644
-index 4286080..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-+++ /dev/null
-@@ -1,205 +0,0 @@
--commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 15:08:07 2020 +0100
--
--    updated main
--
--commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:57:39 2020 +0100
--
--    main hej
--
--commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
--Merge: 551fe5f 8737870
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:50:41 2020 +0100
--
--    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
--
--commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:47:48 2020 +0100
--
--    fixed main
--
--commit 8737870c484cb6b62516b732984a5a89d49758c9
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 14:44:23 2020 +0100
--
--    added fcn define_case()
--
--commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 13:22:18 2020 +0100
--
--    hej
--
--commit 989a9ddbce8c70f8884960c940dff5cb85abe953
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 17:12:55 2020 +0100
--
--    bra skit
--
--commit fcf59768c112e2f710499a11a083ddbf926e90f1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:57:23 2020 +0100
--
--    fixed main
--
--commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:36:26 2020 +0100
--
--    installed configparser, created config.ini and main.py
--
--commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:23:36 2020 +0100
--
--    changed name of folders
--
--commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 15:48:33 2020 +0100
--
--    changed structure, added __init.py files
--
--commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:11:39 2020 +0100
--
--    changed structure
--
--commit 28daae8a8544c14b37f99e8726991791996ad55a
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:09:29 2020 +0100
--
--    Changed structure of repo
--
--commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 13:05:51 2020 +0100
--
--    updated code to get GAIL to run
--
--commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 10:41:03 2020 +0100
--
--    added results
--
--commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:56:40 2020 +0100
--
--    fin
--
--commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:43:09 2020 +0100
--
--    hgi
--
--commit faf34d5f495f4f5424279e5823d168af86fd7291
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:38:52 2020 +0100
--
--    fixed requirements.txt
--
--commit d0bbd5cabbc023ddc00945620543c56372367146
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:08:25 2020 +0100
--
--    added deepirl
--
--commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:06:32 2020 +0100
--
--    fixni
--
--commit 13215698e0d7d48d404df1075c540037bc470a59
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:00:49 2020 +0100
--
--    added files for custom_env
--
--commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 16:09:26 2020 +0100
--
--    fixed .npz file
--
--commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Tue Feb 4 16:08:32 2020 +0100
--
--    created env
--
--commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:54:48 2020 +0100
--
--    added traj
--
--commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
--Merge: 89e455b 585fa30
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:39:11 2020 +0100
--
--    gij
--
--commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:38:22 2020 +0100
--
--    gg
--
--commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:36:44 2020 +0100
--
--    changed in user class
--
--commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:19 2020 +0100
--
--    Delete gail_pendulum.zip
--
--commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:10 2020 +0100
--
--    Delete expert_pendulum.npz
--
--commit 5d83000b84635f517ffd723a2f47424e75a16f80
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 16:30:13 2020 +0100
--
--    feature extraction + plots changed
--
--commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 11:57:18 2020 +0100
--
--    added generate_data.py
--
--commit 216496211fab6141cd7fcc891228f8692350a3ff
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 08:41:26 2020 +0100
--
--    Tested different ways to compare time series
--
--commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Jan 21 15:17:48 2020 +0100
--
--    first commit
--
--commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Jan 20 09:53:42 2020 +0100
--
--    Initial commit
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-deleted file mode 100644
-index 953dca0..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-+++ /dev/null
-@@ -1,16 +0,0 @@
--On branch master
--Your branch is up to date with 'origin/master'.
--
--Changes not staged for commit:
--  (use "git add <file>..." to update what will be committed)
--  (use "git checkout -- <file>..." to discard changes in working directory)
--
--	modified:   expert_trajectories.npz
--	modified:   main.py
--
--Untracked files:
--  (use "git add <file>..." to include in what will be committed)
--
--	results/discrete_events/
--
--no changes added to commit (use "git add" and/or "git commit -a")
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-deleted file mode 100644
-index 99dfa5e..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-deleted file mode 100644
-index fc48d49..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz and /dev/null differ
-diff --git a/temp_main.py b/temp_main.py
-index a507968..cb6f559 100644
---- a/temp_main.py
-+++ b/temp_main.py
-@@ -1,47 +1,331 @@
--from customer_behaviour.tools import dgm as dgm
--from customer_behaviour.tools.generate_data import User 
-+"""An example of training PPO against OpenAI Gym Envs.
-+
-+This script is an example of training a PPO agent against OpenAI Gym envs.
-+Both discrete and continuous action spaces are supported.
-+
-+To solve CartPole-v0, run:
-+    python train_ppo_gym.py --env CartPole-v0
-+"""
-+
-+import sys
- import os
-+import datetime
- import argparse
--import subprocess
--import numpy as np
-+from os.path import join
-+#sys.path.append(os.getcwd())
-+
-+
-+import gym
-+import custom_gym
-+import gym.wrappers
-+
-+import chainer
-+from chainer import functions as F
-+import chainerrl
-+
-+from chainerrl.agents import a3c
-+from chainerrl.agents import PPO
-+from chainerrl import experiments
-+from chainerrl import links
-+from chainerrl import misc
-+from chainerrl.optimizers.nonbias_weight_decay import NonbiasWeightDecay
-+from chainerrl import policies
-+
-+
-+class A3CFFSoftmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward softmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.SoftmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFMellowmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward mellowmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.MellowmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFGaussian(chainer.Chain, a3c.A3CModel):
-+    """An example of A3C feedforward Gaussian policy."""
-+
-+    def __init__(self, obs_size, action_space,
-+                 n_hidden_layers=2, n_hidden_channels=64,
-+                 bound_mean=None):
-+        assert bound_mean in [False, True]
-+        super().__init__()
-+        hidden_sizes = (n_hidden_channels,) * n_hidden_layers
-+        with self.init_scope():
-+            self.pi = policies.FCGaussianPolicyWithStateIndependentCovariance(
-+                obs_size, action_space.low.size,
-+                n_hidden_layers, n_hidden_channels,
-+                var_type='diagonal', nonlinearity=F.tanh,
-+                bound_mean=bound_mean,
-+                min_action=action_space.low, max_action=action_space.high,
-+                mean_wscale=1e-2)
-+            self.v = links.MLP(obs_size, 1, hidden_sizes=hidden_sizes)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+def save_agent_demo(env, agent, out_dir, max_t=2000):
-+    import numpy as np
-+    r, t = 0, 0
-+    agent_observations = []
-+    agent_actions = []
-+    while t < max_t:
-+        agent_observations.append([])
-+        agent_actions.append([])
-+        obs = env.reset()
-+        while True:
-+            act = agent.act(obs)
-+            agent_observations[-1].append(obs)
-+            agent_actions[-1].append(act)
-+            obs, reward, done, _ = env.step(act)
-+            t += 1
-+            r += reward
-+            if done or t >= max_t:
-+                print(t)
-+                break
-+
-+    # save numpy array consists of lists
-+    np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
-+             actions=np.array(agent_actions, dtype=object))
-+
-+def get_outdir(algo, case, n_experts, n_categories):
-+
-+    if not os.path.exists('results'): os.makedirs('results')
-+
-+    path = join('results', str(algo))
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, case)
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_experts) + '_expert(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_categories) + '_product(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-+    path = join(path, time)
-+
-+    return path
-+
-+
-+def get_env(case, n_experts):
-+    if case == 'discrete_events':
-+        env = 'discrete-buying-events-v0'
-+    elif case == 'full_receipt':
-+        env = ''
-+
-+    return env
-+
-+def str2bool(v):
-+    if isinstance(v, bool):
-+       return v
-+    if v.lower() in ('yes', 'True', 't', 'y', '1', 'true'):
-+        return True
-+    elif v.lower() in ('no', 'False', 'f', 'n', '0', 'false'):
-+        return False
-+    else:
-+        raise argparse.ArgumentTypeError('Boolean value expected.')
-+
-+
-+def main():
-+    import logging
- 
--def main(case = 'discrete_events'):
-     parser = argparse.ArgumentParser()
-     parser.add_argument('algo', default='gail', choices=['gail', 'airl'], type=str)
--    parser.add_argument('--case', type=str, default=case)
-+    parser.add_argument('--gpu', type=int, default=0)
-+    parser.add_argument('--case', type=str, default='discrete_events')
-     parser.add_argument('--n_experts', type=int, default=1)
--    parser.add_argument('--n_steps', type=int, default=10000)
-+    parser.add_argument('--n_categories', type=int, default=1)
-+    parser.add_argument('--seed_expert', type=str2bool, nargs='?',
-+                        const=True, default=False,
-+                        help="Activate nice mode.")
-+    parser.add_argument('--arch', type=str, default='FFSoftmax',
-+                        choices=('FFSoftmax', 'FFMellowmax',
-+                                 'FFGaussian'))
-+    parser.add_argument('--bound-mean', action='store_true')
-+    parser.add_argument('--seed', type=int, default=0,
-+                        help='Random seed [0, 2 ** 32)')
-+    #parser.add_argument('--outdir', type=str, default='results', help='Directory path to save output files.'' If it does not exist, it will be created.')
-+    parser.add_argument('--steps', type=int, default=10 ** 6)
-+    parser.add_argument('--eval-interval', type=int, default=10000)
-+    parser.add_argument('--eval-n-runs', type=int, default=10)
-+    parser.add_argument('--reward-scale-factor', type=float, default=1e-2)
-+    parser.add_argument('--standardize-advantages', action='store_true')
-+    parser.add_argument('--render', action='store_true', default=False)
-+    parser.add_argument('--lr', type=float, default=3e-4)
-+    parser.add_argument('--weight-decay', type=float, default=0.0)
-+    parser.add_argument('--demo', action='store_true', default=False)
-+    #parser.add_argument('--load', type=str, default='')
-+    #parser.add_argument('--load_demo', type=str, default='')
-+    parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
-+    parser.add_argument('--monitor', action='store_true')
-+
-+    parser.add_argument('--update-interval', type=int, default=128)
-+    parser.add_argument('--batchsize', type=int, default=64)
-+    parser.add_argument('--epochs', type=int, default=10)
-+    parser.add_argument('--entropy-coef', type=float, default=0.01)
-     args = parser.parse_args()
-+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-+    args.env = get_env(args.case, args.n_experts)
- 
--    env = find_env(args.case, args.n_experts)
-+    logging.basicConfig(level=args.logger_level)
- 
--    n_experts = 1
-+    # Set a random seed used in ChainerRL
-+    misc.set_random_seed(args.seed, gpus=(args.gpu,))
- 
--    demo_states = []
--    demo_actions = []
-+    if not (args.demo and args.load):
-+        args.outdir = experiments.prepare_output_dir(args, args.outdir)
- 
--    for i in range(n_experts):
--        usr = User(time_steps = 128)
--        states, actions = usr.generate_trajectory()
--        demo_states.append(states)
--        demo_actions.append(actions)
-+    def make_env(test):
-+        env = gym.make(args.env)
-+        env.define_case(0, 0, 7*[0])
- 
--    PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--    np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--             actions=np.array(demo_actions, dtype=object)) 
--    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--    s = subprocess.Popen(command)
-+        # Use different random seeds for train and test envs
-+        env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
-+        env.seed(env_seed)
-+        # Cast observations to float32 because our model uses float32
-+        env = chainerrl.wrappers.CastObservationToFloat32(env)
-+        if args.monitor:
-+            env = gym.wrappers.Monitor(env, args.outdir)
-+        if not test:
-+            # Scale rewards (and thus returns) to a reasonable range so that
-+            # training is easier
-+            env = chainerrl.wrappers.ScaleReward(env, args.reward_scale_factor)
-+        if args.render:
-+            env = chainerrl.wrappers.Render(env)
-+        return env
- 
--def find_env(case, n_experts):
--    if case == 'discrete_events':
--        if n_experts == 1:
--            env = 'discrete-buying-events-v0'
-+    sample_env = gym.make(args.env)
-+    sample_env.define_case(0, 0, 7*[0])
-+    timestep_limit = sample_env.spec.tags.get(
-+        'wrapper_config.TimeLimit.max_episode_steps')
-+    obs_space = sample_env.observation_space
-+    action_space = sample_env.action_space
- 
--    if case == 'full_receipt':
--        if n_experts == 1:
--            env = ''
-+    # Normalize observations based on their empirical mean and variance
- 
--    return env
-+    obs_normalizer = None                                                                # HarDKODAT
-+    #chainerrl.links.EmpiricalNormalization(obs_space.low.size, clip_threshold=5)
-+
-+    # Switch policy types accordingly to action space types
-+    if args.arch == 'FFSoftmax':
-+        model = A3CFFSoftmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFMellowmax':
-+        model = A3CFFMellowmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFGaussian':
-+        model = A3CFFGaussian(obs_space.low.size, action_space,
-+                              bound_mean=args.bound_mean)
-+
-+    opt = chainer.optimizers.Adam(alpha=args.lr, eps=1e-5)
-+    opt.setup(model)
-+    if args.weight_decay > 0:
-+        opt.add_hook(NonbiasWeightDecay(args.weight_decay))
-+    if args.algo == 'ppo':
-+        agent = PPO(model, opt,
-+                    obs_normalizer=obs_normalizer,
-+                    gpu=args.gpu,
-+                    update_interval=args.update_interval,
-+                    minibatch_size=args.batchsize, epochs=args.epochs,
-+                    clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                    standardize_advantages=args.standardize_advantages,
-+                    )
-+    elif args.algo == 'gail':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.gail import GAIL
-+        from customer_behaviour.algorithms.irl.gail import Discriminator
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = GAIL(demonstrations=demonstrations, discriminator=D,
-+                     model=model, optimizer=opt,
-+                     obs_normalizer=obs_normalizer,
-+                     gpu=args.gpu,
-+                     update_interval=args.update_interval,
-+                     minibatch_size=args.batchsize, epochs=args.epochs,
-+                     clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                     standardize_advantages=args.standardize_advantages,)
-+    elif args.algo == 'airl':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.airl import AIRL as Agent
-+        from customer_behaviour.algorithms.irl.airl import Discriminator
-+        # obs_normalizer = None
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = Agent(demonstrations=demonstrations, discriminator=D,
-+                      model=model, optimizer=opt,
-+                      obs_normalizer=obs_normalizer,
-+                      gpu=args.gpu,
-+                      update_interval=args.update_interval,
-+                      minibatch_size=args.batchsize, epochs=args.epochs,
-+                      clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                      standardize_advantages=args.standardize_advantages,)
-+
-+    if args.load:
-+        agent.load(args.load)
-+
-+    if args.demo:
-+        env = make_env(True)
-+        eval_stats = experiments.eval_performance(
-+            env=env,
-+            agent=agent,
-+            n_steps=None,
-+            n_episodes=args.eval_n_runs,
-+            max_episode_len=timestep_limit)
-+        print('n_runs: {} mean: {} median: {} stdev {}'.format(
-+            args.eval_n_runs, eval_stats['mean'], eval_stats['median'],
-+            eval_stats['stdev']))
-+        outdir = args.load if args.load else args.outdir
-+        save_agent_demo(make_env(False), agent, outdir)
-+    else:
-+        # Linearly decay the learning rate to zero
-+        def lr_setter(env, agent, value):
-+            agent.optimizer.alpha = value
-+
-+        lr_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, args.lr, 0, lr_setter)
-+
-+        # Linearly decay the clipping parameter to zero
-+        def clip_eps_setter(env, agent, value):
-+            agent.clip_eps = max(value, 1e-8)
-+
-+        clip_eps_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, 0.2, 0, clip_eps_setter)
-+
-+        experiments.train_agent_with_evaluation(
-+            agent=agent,
-+            env=make_env(False),
-+            eval_env=make_env(True),
-+            outdir=args.outdir,
-+            steps=args.steps,
-+            eval_n_steps=None,
-+            eval_n_episodes=args.eval_n_runs,
-+            eval_interval=args.eval_interval,
-+            train_max_episode_len=timestep_limit,
-+            save_best_so_far_agent=False,
-+            step_hooks=[
-+                lr_decay_hook,
-+                clip_eps_decay_hook,
-+            ],
-+        )
-+        save_agent_demo(make_env(False), agent, args.outdir)
- 
- 
- if __name__ == '__main__':
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-head.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-head.txt
deleted file mode 100644
index ed95f27..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-head.txt
+++ /dev/null
@@ -1 +0,0 @@
-92fa4b893bc749ddaa3a3d107d383d7ad35748f5
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-log.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-log.txt
deleted file mode 100644
index a91c7dc..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-log.txt
+++ /dev/null
@@ -1,211 +0,0 @@
-commit 92fa4b893bc749ddaa3a3d107d383d7ad35748f5
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Mon Feb 10 08:44:27 2020 +0100
-
-    kfj
-
-commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 15:08:07 2020 +0100
-
-    updated main
-
-commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:57:39 2020 +0100
-
-    main hej
-
-commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
-Merge: 551fe5f 8737870
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:50:41 2020 +0100
-
-    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
-
-commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:47:48 2020 +0100
-
-    fixed main
-
-commit 8737870c484cb6b62516b732984a5a89d49758c9
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 14:44:23 2020 +0100
-
-    added fcn define_case()
-
-commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 13:22:18 2020 +0100
-
-    hej
-
-commit 989a9ddbce8c70f8884960c940dff5cb85abe953
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 17:12:55 2020 +0100
-
-    bra skit
-
-commit fcf59768c112e2f710499a11a083ddbf926e90f1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:57:23 2020 +0100
-
-    fixed main
-
-commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:36:26 2020 +0100
-
-    installed configparser, created config.ini and main.py
-
-commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:23:36 2020 +0100
-
-    changed name of folders
-
-commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 15:48:33 2020 +0100
-
-    changed structure, added __init.py files
-
-commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:11:39 2020 +0100
-
-    changed structure
-
-commit 28daae8a8544c14b37f99e8726991791996ad55a
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:09:29 2020 +0100
-
-    Changed structure of repo
-
-commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 13:05:51 2020 +0100
-
-    updated code to get GAIL to run
-
-commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 10:41:03 2020 +0100
-
-    added results
-
-commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:56:40 2020 +0100
-
-    fin
-
-commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:43:09 2020 +0100
-
-    hgi
-
-commit faf34d5f495f4f5424279e5823d168af86fd7291
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:38:52 2020 +0100
-
-    fixed requirements.txt
-
-commit d0bbd5cabbc023ddc00945620543c56372367146
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:08:25 2020 +0100
-
-    added deepirl
-
-commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:06:32 2020 +0100
-
-    fixni
-
-commit 13215698e0d7d48d404df1075c540037bc470a59
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:00:49 2020 +0100
-
-    added files for custom_env
-
-commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 16:09:26 2020 +0100
-
-    fixed .npz file
-
-commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Tue Feb 4 16:08:32 2020 +0100
-
-    created env
-
-commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:54:48 2020 +0100
-
-    added traj
-
-commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
-Merge: 89e455b 585fa30
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:39:11 2020 +0100
-
-    gij
-
-commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:38:22 2020 +0100
-
-    gg
-
-commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:36:44 2020 +0100
-
-    changed in user class
-
-commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:19 2020 +0100
-
-    Delete gail_pendulum.zip
-
-commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:10 2020 +0100
-
-    Delete expert_pendulum.npz
-
-commit 5d83000b84635f517ffd723a2f47424e75a16f80
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 16:30:13 2020 +0100
-
-    feature extraction + plots changed
-
-commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 11:57:18 2020 +0100
-
-    added generate_data.py
-
-commit 216496211fab6141cd7fcc891228f8692350a3ff
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 08:41:26 2020 +0100
-
-    Tested different ways to compare time series
-
-commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Jan 21 15:17:48 2020 +0100
-
-    first commit
-
-commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Jan 20 09:53:42 2020 +0100
-
-    Initial commit
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-status.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-status.txt
deleted file mode 100644
index bba909f..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-51-00/20200210T095100.846498/git-status.txt
+++ /dev/null
@@ -1,30 +0,0 @@
-On branch master
-Your branch is up to date with 'origin/master'.
-
-Changes not staged for commit:
-  (use "git add/rm <file>..." to update what will be committed)
-  (use "git checkout -- <file>..." to discard changes in working directory)
-
-	deleted:    config.ini
-	modified:   customer_behaviour/algorithms/irl/airl/discriminator.py
-	modified:   customer_behaviour/algorithms/irl/common/utils/__init__.py
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-	modified:   temp_main.py
-
-Untracked files:
-  (use "git add <file>..." to include in what will be committed)
-
-	results/airl/
-	results/gail/
-
-no changes added to commit (use "git add" and/or "git commit -a")
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/args.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/args.txt
deleted file mode 100644
index 34c6dbc..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/args.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"algo": "gail", "gpu": -1, "case": "discrete_events", "n_experts": 1, "n_categories": 1, "seed_expert": false, "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01, "outdir": "results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09", "env": "discrete-buying-events-v0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/command.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/command.txt
deleted file mode 100644
index b1b771d..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/command.txt
+++ /dev/null
@@ -1 +0,0 @@
-temp_main.py gail --gpu -1 --case discrete_events --n_experts 1 --n_categories 1 --steps 10 --seed_expert False --load_demo expert_trajectories.npz
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/environ.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/environ.txt
deleted file mode 100644
index 9c1bbd9..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/environ.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"TERM_PROGRAM": "Apple_Terminal", "TERM": "xterm-256color", "SHELL": "/bin/bash", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.gjMnJvQ4ux/Render", "TERM_PROGRAM_VERSION": "421.2", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.4I4GqXIb2y/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "HOME": "/Users/victor", "SHLVL": "1", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-diff.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-diff.txt
deleted file mode 100644
index de53d66..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-diff.txt
+++ /dev/null
@@ -1,722 +0,0 @@
-diff --git a/config.ini b/config.ini
-deleted file mode 100644
-index 0b70f3c..0000000
---- a/config.ini
-+++ /dev/null
-@@ -1,11 +0,0 @@
--[DEFAULT]
--
--
--[discrete_events]
--N_EXPERTS = 1
--N_PRODUCTS = 1
--
--[full_receipts]
--N_EXPERTS = 1
--N_PRODUCTS = 6
--
-diff --git a/customer_behaviour/algorithms/irl/airl/discriminator.py b/customer_behaviour/algorithms/irl/airl/discriminator.py
-index 931e98e..cdc5c9d 100755
---- a/customer_behaviour/algorithms/irl/airl/discriminator.py
-+++ b/customer_behaviour/algorithms/irl/airl/discriminator.py
-@@ -1,6 +1,6 @@
- import chainer
- import chainer.functions as F
--from irl.common.model import MLP
-+from customer_behaviour.algorithms.irl.common.model import MLP
- from chainer.link_hooks.spectral_normalization import SpectralNormalization
- 
- 
-diff --git a/customer_behaviour/algorithms/irl/common/utils/__init__.py b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-index f808b8c..2c9d8c4 100755
---- a/customer_behaviour/algorithms/irl/common/utils/__init__.py
-+++ b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-@@ -1 +1 @@
--from irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-+from customer_behaviour.algorithms.irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-deleted file mode 100644
-index f0dec34..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-deleted file mode 100644
-index eecd553..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-deleted file mode 100644
-index c122e59..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"algo": "airl", "gpu": -1, "env": "discrete-buying-events-v0", "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "outdir": "results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43", "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-deleted file mode 100644
-index 913e5b6..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--customer_behaviour/algorithms/train_gym.py airl --gpu -1 --env discrete-buying-events-v0 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01 --outdir results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-deleted file mode 100644
-index ef43d43..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"TERM_PROGRAM": "Apple_Terminal", "SHELL": "/bin/bash", "TERM": "xterm-256color", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.JuAPseFAEM/Render", "TERM_PROGRAM_VERSION": "421.2", "OLDPWD": "/Users/victor/Documents/CAS_2/Master_thesis", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.b16K4t4cKk/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "SHLVL": "1", "HOME": "/Users/victor", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-deleted file mode 100644
-index 341b94d..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-+++ /dev/null
-@@ -1,30 +0,0 @@
--diff --git a/expert_trajectories.npz b/expert_trajectories.npz
--index 6fd7b82..04a5abf 100644
--Binary files a/expert_trajectories.npz and b/expert_trajectories.npz differ
--diff --git a/main.py b/main.py
--index 60a144f..adf5222 100644
----- a/main.py
--+++ b/main.py
--@@ -19,12 +19,10 @@ def main(case = 'discrete_events'):
-- 
--     outdir = get_outdir(args.case, args.n_experts, n_categories=1)
-- 
---    n_experts = 1
---
--     demo_states = []
--     demo_actions = []
-- 
---    for i in range(n_experts):
--+    for i in range(args.n_experts):
--         usr = User(time_steps = 128)
--         states, actions = usr.generate_trajectory()
--         demo_states.append(states)
--@@ -33,7 +31,7 @@ def main(case = 'discrete_events'):
--     PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--     np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--              actions=np.array(demo_actions, dtype=object)) 
---    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--+    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01', '--outdir', outdir]
--     s = subprocess.Popen(command)
-- 
-- 
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-deleted file mode 100644
-index c32b34f..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-deleted file mode 100644
-index 4286080..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-+++ /dev/null
-@@ -1,205 +0,0 @@
--commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 15:08:07 2020 +0100
--
--    updated main
--
--commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:57:39 2020 +0100
--
--    main hej
--
--commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
--Merge: 551fe5f 8737870
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:50:41 2020 +0100
--
--    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
--
--commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:47:48 2020 +0100
--
--    fixed main
--
--commit 8737870c484cb6b62516b732984a5a89d49758c9
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 14:44:23 2020 +0100
--
--    added fcn define_case()
--
--commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 13:22:18 2020 +0100
--
--    hej
--
--commit 989a9ddbce8c70f8884960c940dff5cb85abe953
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 17:12:55 2020 +0100
--
--    bra skit
--
--commit fcf59768c112e2f710499a11a083ddbf926e90f1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:57:23 2020 +0100
--
--    fixed main
--
--commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:36:26 2020 +0100
--
--    installed configparser, created config.ini and main.py
--
--commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:23:36 2020 +0100
--
--    changed name of folders
--
--commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 15:48:33 2020 +0100
--
--    changed structure, added __init.py files
--
--commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:11:39 2020 +0100
--
--    changed structure
--
--commit 28daae8a8544c14b37f99e8726991791996ad55a
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:09:29 2020 +0100
--
--    Changed structure of repo
--
--commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 13:05:51 2020 +0100
--
--    updated code to get GAIL to run
--
--commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 10:41:03 2020 +0100
--
--    added results
--
--commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:56:40 2020 +0100
--
--    fin
--
--commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:43:09 2020 +0100
--
--    hgi
--
--commit faf34d5f495f4f5424279e5823d168af86fd7291
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:38:52 2020 +0100
--
--    fixed requirements.txt
--
--commit d0bbd5cabbc023ddc00945620543c56372367146
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:08:25 2020 +0100
--
--    added deepirl
--
--commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:06:32 2020 +0100
--
--    fixni
--
--commit 13215698e0d7d48d404df1075c540037bc470a59
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:00:49 2020 +0100
--
--    added files for custom_env
--
--commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 16:09:26 2020 +0100
--
--    fixed .npz file
--
--commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Tue Feb 4 16:08:32 2020 +0100
--
--    created env
--
--commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:54:48 2020 +0100
--
--    added traj
--
--commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
--Merge: 89e455b 585fa30
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:39:11 2020 +0100
--
--    gij
--
--commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:38:22 2020 +0100
--
--    gg
--
--commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:36:44 2020 +0100
--
--    changed in user class
--
--commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:19 2020 +0100
--
--    Delete gail_pendulum.zip
--
--commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:10 2020 +0100
--
--    Delete expert_pendulum.npz
--
--commit 5d83000b84635f517ffd723a2f47424e75a16f80
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 16:30:13 2020 +0100
--
--    feature extraction + plots changed
--
--commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 11:57:18 2020 +0100
--
--    added generate_data.py
--
--commit 216496211fab6141cd7fcc891228f8692350a3ff
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 08:41:26 2020 +0100
--
--    Tested different ways to compare time series
--
--commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Jan 21 15:17:48 2020 +0100
--
--    first commit
--
--commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Jan 20 09:53:42 2020 +0100
--
--    Initial commit
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-deleted file mode 100644
-index 953dca0..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-+++ /dev/null
-@@ -1,16 +0,0 @@
--On branch master
--Your branch is up to date with 'origin/master'.
--
--Changes not staged for commit:
--  (use "git add <file>..." to update what will be committed)
--  (use "git checkout -- <file>..." to discard changes in working directory)
--
--	modified:   expert_trajectories.npz
--	modified:   main.py
--
--Untracked files:
--  (use "git add <file>..." to include in what will be committed)
--
--	results/discrete_events/
--
--no changes added to commit (use "git add" and/or "git commit -a")
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-deleted file mode 100644
-index 99dfa5e..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-deleted file mode 100644
-index fc48d49..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz and /dev/null differ
-diff --git a/temp_main.py b/temp_main.py
-index a507968..2ee2bf5 100644
---- a/temp_main.py
-+++ b/temp_main.py
-@@ -1,47 +1,331 @@
--from customer_behaviour.tools import dgm as dgm
--from customer_behaviour.tools.generate_data import User 
-+"""An example of training PPO against OpenAI Gym Envs.
-+
-+This script is an example of training a PPO agent against OpenAI Gym envs.
-+Both discrete and continuous action spaces are supported.
-+
-+To solve CartPole-v0, run:
-+    python train_ppo_gym.py --env CartPole-v0
-+"""
-+
-+import sys
- import os
-+import datetime
- import argparse
--import subprocess
--import numpy as np
-+from os.path import join
-+#sys.path.append(os.getcwd())
-+
-+
-+import gym
-+import custom_gym
-+import gym.wrappers
-+
-+import chainer
-+from chainer import functions as F
-+import chainerrl
-+
-+from chainerrl.agents import a3c
-+from chainerrl.agents import PPO
-+from chainerrl import experiments
-+from chainerrl import links
-+from chainerrl import misc
-+from chainerrl.optimizers.nonbias_weight_decay import NonbiasWeightDecay
-+from chainerrl import policies
-+
-+
-+class A3CFFSoftmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward softmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.SoftmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFMellowmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward mellowmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.MellowmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFGaussian(chainer.Chain, a3c.A3CModel):
-+    """An example of A3C feedforward Gaussian policy."""
-+
-+    def __init__(self, obs_size, action_space,
-+                 n_hidden_layers=2, n_hidden_channels=64,
-+                 bound_mean=None):
-+        assert bound_mean in [False, True]
-+        super().__init__()
-+        hidden_sizes = (n_hidden_channels,) * n_hidden_layers
-+        with self.init_scope():
-+            self.pi = policies.FCGaussianPolicyWithStateIndependentCovariance(
-+                obs_size, action_space.low.size,
-+                n_hidden_layers, n_hidden_channels,
-+                var_type='diagonal', nonlinearity=F.tanh,
-+                bound_mean=bound_mean,
-+                min_action=action_space.low, max_action=action_space.high,
-+                mean_wscale=1e-2)
-+            self.v = links.MLP(obs_size, 1, hidden_sizes=hidden_sizes)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+def save_agent_demo(env, agent, out_dir, max_t=2000):
-+    import numpy as np
-+    r, t = 0, 0
-+    agent_observations = []
-+    agent_actions = []
-+    while t < max_t:
-+        agent_observations.append([])
-+        agent_actions.append([])
-+        obs = env.reset()
-+        while True:
-+            act = agent.act(obs)
-+            agent_observations[-1].append(obs)
-+            agent_actions[-1].append(act)
-+            obs, reward, done, _ = env.step(act)
-+            t += 1
-+            r += reward
-+            if done or t >= max_t:
-+                print(t)
-+                break
-+
-+    # save numpy array consists of lists
-+    np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
-+             actions=np.array(agent_actions, dtype=object))
-+
-+def get_outdir(algo, case, n_experts, n_categories):
-+
-+    if not os.path.exists('results'): os.makedirs('results')
-+
-+    path = join('results', str(algo))
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, case)
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_experts) + '_expert(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_categories) + '_product(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-+    path = join(path, time)
-+
-+    return path
-+
-+
-+def get_env(case, n_experts):
-+    if case == 'discrete_events':
-+        env = 'discrete-buying-events-v0'
-+    elif case == 'full_receipt':
-+        env = ''
-+
-+    return env
-+
-+def str2bool(v):
-+    if isinstance(v, bool):
-+       return v
-+    if v.lower() in ('yes', 'True', 't', 'y', '1', 'true'):
-+        return True
-+    elif v.lower() in ('no', 'False', 'f', 'n', '0', 'false'):
-+        return False
-+    else:
-+        raise argparse.ArgumentTypeError('Boolean value expected.')
-+
-+
-+def main():
-+    import logging
- 
--def main(case = 'discrete_events'):
-     parser = argparse.ArgumentParser()
-     parser.add_argument('algo', default='gail', choices=['gail', 'airl'], type=str)
--    parser.add_argument('--case', type=str, default=case)
-+    parser.add_argument('--gpu', type=int, default=0)
-+    parser.add_argument('--case', type=str, default='discrete_events')
-     parser.add_argument('--n_experts', type=int, default=1)
--    parser.add_argument('--n_steps', type=int, default=10000)
-+    parser.add_argument('--n_categories', type=int, default=1)
-+    parser.add_argument('--seed_expert', type=str2bool, nargs='?',
-+                        const=True, default=False,
-+                        help="Activate nice mode.")
-+    parser.add_argument('--arch', type=str, default='FFSoftmax',
-+                        choices=('FFSoftmax', 'FFMellowmax',
-+                                 'FFGaussian'))
-+    parser.add_argument('--bound-mean', action='store_true')
-+    parser.add_argument('--seed', type=int, default=0,
-+                        help='Random seed [0, 2 ** 32)')
-+    #parser.add_argument('--outdir', type=str, default='results', help='Directory path to save output files.'' If it does not exist, it will be created.')
-+    parser.add_argument('--steps', type=int, default=10 ** 6)
-+    parser.add_argument('--eval-interval', type=int, default=10000)
-+    parser.add_argument('--eval-n-runs', type=int, default=10)
-+    parser.add_argument('--reward-scale-factor', type=float, default=1e-2)
-+    parser.add_argument('--standardize-advantages', action='store_true')
-+    parser.add_argument('--render', action='store_true', default=False)
-+    parser.add_argument('--lr', type=float, default=3e-4)
-+    parser.add_argument('--weight-decay', type=float, default=0.0)
-+    parser.add_argument('--demo', action='store_true', default=False)
-+    #parser.add_argument('--load', type=str, default='')
-+    parser.add_argument('--load_demo', type=str, default='')
-+    parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
-+    parser.add_argument('--monitor', action='store_true')
-+
-+    parser.add_argument('--update-interval', type=int, default=128)
-+    parser.add_argument('--batchsize', type=int, default=64)
-+    parser.add_argument('--epochs', type=int, default=10)
-+    parser.add_argument('--entropy-coef', type=float, default=0.01)
-     args = parser.parse_args()
-+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-+    args.env = get_env(args.case, args.n_experts)
- 
--    env = find_env(args.case, args.n_experts)
-+    logging.basicConfig(level=args.logger_level)
- 
--    n_experts = 1
-+    # Set a random seed used in ChainerRL
-+    misc.set_random_seed(args.seed, gpus=(args.gpu,))
- 
--    demo_states = []
--    demo_actions = []
-+    if not (args.demo and args.load):
-+        args.outdir = experiments.prepare_output_dir(args, args.outdir)
- 
--    for i in range(n_experts):
--        usr = User(time_steps = 128)
--        states, actions = usr.generate_trajectory()
--        demo_states.append(states)
--        demo_actions.append(actions)
-+    def make_env(test):
-+        env = gym.make(args.env)
-+        env.define_case(0, 0, 7*[0])
- 
--    PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--    np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--             actions=np.array(demo_actions, dtype=object)) 
--    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--    s = subprocess.Popen(command)
-+        # Use different random seeds for train and test envs
-+        env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
-+        env.seed(env_seed)
-+        # Cast observations to float32 because our model uses float32
-+        env = chainerrl.wrappers.CastObservationToFloat32(env)
-+        if args.monitor:
-+            env = gym.wrappers.Monitor(env, args.outdir)
-+        if not test:
-+            # Scale rewards (and thus returns) to a reasonable range so that
-+            # training is easier
-+            env = chainerrl.wrappers.ScaleReward(env, args.reward_scale_factor)
-+        if args.render:
-+            env = chainerrl.wrappers.Render(env)
-+        return env
- 
--def find_env(case, n_experts):
--    if case == 'discrete_events':
--        if n_experts == 1:
--            env = 'discrete-buying-events-v0'
-+    sample_env = gym.make(args.env)
-+    sample_env.define_case(0, 0, 7*[0])
-+    timestep_limit = sample_env.spec.tags.get(
-+        'wrapper_config.TimeLimit.max_episode_steps')
-+    obs_space = sample_env.observation_space
-+    action_space = sample_env.action_space
- 
--    if case == 'full_receipt':
--        if n_experts == 1:
--            env = ''
-+    # Normalize observations based on their empirical mean and variance
- 
--    return env
-+    obs_normalizer = None                                                                # HarDKODAT
-+    #chainerrl.links.EmpiricalNormalization(obs_space.low.size, clip_threshold=5)
-+
-+    # Switch policy types accordingly to action space types
-+    if args.arch == 'FFSoftmax':
-+        model = A3CFFSoftmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFMellowmax':
-+        model = A3CFFMellowmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFGaussian':
-+        model = A3CFFGaussian(obs_space.low.size, action_space,
-+                              bound_mean=args.bound_mean)
-+
-+    opt = chainer.optimizers.Adam(alpha=args.lr, eps=1e-5)
-+    opt.setup(model)
-+    if args.weight_decay > 0:
-+        opt.add_hook(NonbiasWeightDecay(args.weight_decay))
-+    if args.algo == 'ppo':
-+        agent = PPO(model, opt,
-+                    obs_normalizer=obs_normalizer,
-+                    gpu=args.gpu,
-+                    update_interval=args.update_interval,
-+                    minibatch_size=args.batchsize, epochs=args.epochs,
-+                    clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                    standardize_advantages=args.standardize_advantages,
-+                    )
-+    elif args.algo == 'gail':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.gail import GAIL
-+        from customer_behaviour.algorithms.irl.gail import Discriminator
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = GAIL(demonstrations=demonstrations, discriminator=D,
-+                     model=model, optimizer=opt,
-+                     obs_normalizer=obs_normalizer,
-+                     gpu=args.gpu,
-+                     update_interval=args.update_interval,
-+                     minibatch_size=args.batchsize, epochs=args.epochs,
-+                     clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                     standardize_advantages=args.standardize_advantages,)
-+    elif args.algo == 'airl':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.airl import AIRL as Agent
-+        from customer_behaviour.algorithms.irl.airl import Discriminator
-+        # obs_normalizer = None
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = Agent(demonstrations=demonstrations, discriminator=D,
-+                      model=model, optimizer=opt,
-+                      obs_normalizer=obs_normalizer,
-+                      gpu=args.gpu,
-+                      update_interval=args.update_interval,
-+                      minibatch_size=args.batchsize, epochs=args.epochs,
-+                      clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                      standardize_advantages=args.standardize_advantages,)
-+
-+    if args.load:
-+        agent.load(args.load)
-+
-+    if args.demo:
-+        env = make_env(True)
-+        eval_stats = experiments.eval_performance(
-+            env=env,
-+            agent=agent,
-+            n_steps=None,
-+            n_episodes=args.eval_n_runs,
-+            max_episode_len=timestep_limit)
-+        print('n_runs: {} mean: {} median: {} stdev {}'.format(
-+            args.eval_n_runs, eval_stats['mean'], eval_stats['median'],
-+            eval_stats['stdev']))
-+        outdir = args.load if args.load else args.outdir
-+        save_agent_demo(make_env(False), agent, outdir)
-+    else:
-+        # Linearly decay the learning rate to zero
-+        def lr_setter(env, agent, value):
-+            agent.optimizer.alpha = value
-+
-+        lr_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, args.lr, 0, lr_setter)
-+
-+        # Linearly decay the clipping parameter to zero
-+        def clip_eps_setter(env, agent, value):
-+            agent.clip_eps = max(value, 1e-8)
-+
-+        clip_eps_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, 0.2, 0, clip_eps_setter)
-+
-+        experiments.train_agent_with_evaluation(
-+            agent=agent,
-+            env=make_env(False),
-+            eval_env=make_env(True),
-+            outdir=args.outdir,
-+            steps=args.steps,
-+            eval_n_steps=None,
-+            eval_n_episodes=args.eval_n_runs,
-+            eval_interval=args.eval_interval,
-+            train_max_episode_len=timestep_limit,
-+            save_best_so_far_agent=False,
-+            step_hooks=[
-+                lr_decay_hook,
-+                clip_eps_decay_hook,
-+            ],
-+        )
-+        save_agent_demo(make_env(False), agent, args.outdir)
- 
- 
- if __name__ == '__main__':
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-head.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-head.txt
deleted file mode 100644
index ed95f27..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-head.txt
+++ /dev/null
@@ -1 +0,0 @@
-92fa4b893bc749ddaa3a3d107d383d7ad35748f5
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-log.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-log.txt
deleted file mode 100644
index a91c7dc..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-log.txt
+++ /dev/null
@@ -1,211 +0,0 @@
-commit 92fa4b893bc749ddaa3a3d107d383d7ad35748f5
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Mon Feb 10 08:44:27 2020 +0100
-
-    kfj
-
-commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 15:08:07 2020 +0100
-
-    updated main
-
-commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:57:39 2020 +0100
-
-    main hej
-
-commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
-Merge: 551fe5f 8737870
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:50:41 2020 +0100
-
-    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
-
-commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:47:48 2020 +0100
-
-    fixed main
-
-commit 8737870c484cb6b62516b732984a5a89d49758c9
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 14:44:23 2020 +0100
-
-    added fcn define_case()
-
-commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 13:22:18 2020 +0100
-
-    hej
-
-commit 989a9ddbce8c70f8884960c940dff5cb85abe953
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 17:12:55 2020 +0100
-
-    bra skit
-
-commit fcf59768c112e2f710499a11a083ddbf926e90f1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:57:23 2020 +0100
-
-    fixed main
-
-commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:36:26 2020 +0100
-
-    installed configparser, created config.ini and main.py
-
-commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:23:36 2020 +0100
-
-    changed name of folders
-
-commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 15:48:33 2020 +0100
-
-    changed structure, added __init.py files
-
-commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:11:39 2020 +0100
-
-    changed structure
-
-commit 28daae8a8544c14b37f99e8726991791996ad55a
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:09:29 2020 +0100
-
-    Changed structure of repo
-
-commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 13:05:51 2020 +0100
-
-    updated code to get GAIL to run
-
-commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 10:41:03 2020 +0100
-
-    added results
-
-commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:56:40 2020 +0100
-
-    fin
-
-commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:43:09 2020 +0100
-
-    hgi
-
-commit faf34d5f495f4f5424279e5823d168af86fd7291
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:38:52 2020 +0100
-
-    fixed requirements.txt
-
-commit d0bbd5cabbc023ddc00945620543c56372367146
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:08:25 2020 +0100
-
-    added deepirl
-
-commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:06:32 2020 +0100
-
-    fixni
-
-commit 13215698e0d7d48d404df1075c540037bc470a59
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:00:49 2020 +0100
-
-    added files for custom_env
-
-commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 16:09:26 2020 +0100
-
-    fixed .npz file
-
-commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Tue Feb 4 16:08:32 2020 +0100
-
-    created env
-
-commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:54:48 2020 +0100
-
-    added traj
-
-commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
-Merge: 89e455b 585fa30
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:39:11 2020 +0100
-
-    gij
-
-commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:38:22 2020 +0100
-
-    gg
-
-commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:36:44 2020 +0100
-
-    changed in user class
-
-commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:19 2020 +0100
-
-    Delete gail_pendulum.zip
-
-commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:10 2020 +0100
-
-    Delete expert_pendulum.npz
-
-commit 5d83000b84635f517ffd723a2f47424e75a16f80
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 16:30:13 2020 +0100
-
-    feature extraction + plots changed
-
-commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 11:57:18 2020 +0100
-
-    added generate_data.py
-
-commit 216496211fab6141cd7fcc891228f8692350a3ff
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 08:41:26 2020 +0100
-
-    Tested different ways to compare time series
-
-commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Jan 21 15:17:48 2020 +0100
-
-    first commit
-
-commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Jan 20 09:53:42 2020 +0100
-
-    Initial commit
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-status.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-status.txt
deleted file mode 100644
index bba909f..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-09/20200210T095209.962178/git-status.txt
+++ /dev/null
@@ -1,30 +0,0 @@
-On branch master
-Your branch is up to date with 'origin/master'.
-
-Changes not staged for commit:
-  (use "git add/rm <file>..." to update what will be committed)
-  (use "git checkout -- <file>..." to discard changes in working directory)
-
-	deleted:    config.ini
-	modified:   customer_behaviour/algorithms/irl/airl/discriminator.py
-	modified:   customer_behaviour/algorithms/irl/common/utils/__init__.py
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-	modified:   temp_main.py
-
-Untracked files:
-  (use "git add <file>..." to include in what will be committed)
-
-	results/airl/
-	results/gail/
-
-no changes added to commit (use "git add" and/or "git commit -a")
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/10_finish/model.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/10_finish/model.npz
deleted file mode 100644
index 6d7f2be..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/10_finish/model.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/10_finish/optimizer.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/10_finish/optimizer.npz
deleted file mode 100644
index eecd553..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/10_finish/optimizer.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/args.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/args.txt
deleted file mode 100644
index c64df60..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/args.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"algo": "gail", "gpu": -1, "case": "discrete_events", "n_experts": 1, "n_categories": 1, "seed_expert": false, "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01, "outdir": "results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24", "env": "discrete-buying-events-v0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/command.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/command.txt
deleted file mode 100644
index b1b771d..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/command.txt
+++ /dev/null
@@ -1 +0,0 @@
-temp_main.py gail --gpu -1 --case discrete_events --n_experts 1 --n_categories 1 --steps 10 --seed_expert False --load_demo expert_trajectories.npz
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/environ.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/environ.txt
deleted file mode 100644
index 9c1bbd9..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/environ.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"TERM_PROGRAM": "Apple_Terminal", "TERM": "xterm-256color", "SHELL": "/bin/bash", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.gjMnJvQ4ux/Render", "TERM_PROGRAM_VERSION": "421.2", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.4I4GqXIb2y/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "HOME": "/Users/victor", "SHLVL": "1", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-diff.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-diff.txt
deleted file mode 100644
index c1571d6..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-diff.txt
+++ /dev/null
@@ -1,722 +0,0 @@
-diff --git a/config.ini b/config.ini
-deleted file mode 100644
-index 0b70f3c..0000000
---- a/config.ini
-+++ /dev/null
-@@ -1,11 +0,0 @@
--[DEFAULT]
--
--
--[discrete_events]
--N_EXPERTS = 1
--N_PRODUCTS = 1
--
--[full_receipts]
--N_EXPERTS = 1
--N_PRODUCTS = 6
--
-diff --git a/customer_behaviour/algorithms/irl/airl/discriminator.py b/customer_behaviour/algorithms/irl/airl/discriminator.py
-index 931e98e..cdc5c9d 100755
---- a/customer_behaviour/algorithms/irl/airl/discriminator.py
-+++ b/customer_behaviour/algorithms/irl/airl/discriminator.py
-@@ -1,6 +1,6 @@
- import chainer
- import chainer.functions as F
--from irl.common.model import MLP
-+from customer_behaviour.algorithms.irl.common.model import MLP
- from chainer.link_hooks.spectral_normalization import SpectralNormalization
- 
- 
-diff --git a/customer_behaviour/algorithms/irl/common/utils/__init__.py b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-index f808b8c..2c9d8c4 100755
---- a/customer_behaviour/algorithms/irl/common/utils/__init__.py
-+++ b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-@@ -1 +1 @@
--from irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-+from customer_behaviour.algorithms.irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-deleted file mode 100644
-index f0dec34..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-deleted file mode 100644
-index eecd553..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-deleted file mode 100644
-index c122e59..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"algo": "airl", "gpu": -1, "env": "discrete-buying-events-v0", "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "outdir": "results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43", "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-deleted file mode 100644
-index 913e5b6..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--customer_behaviour/algorithms/train_gym.py airl --gpu -1 --env discrete-buying-events-v0 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01 --outdir results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-deleted file mode 100644
-index ef43d43..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"TERM_PROGRAM": "Apple_Terminal", "SHELL": "/bin/bash", "TERM": "xterm-256color", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.JuAPseFAEM/Render", "TERM_PROGRAM_VERSION": "421.2", "OLDPWD": "/Users/victor/Documents/CAS_2/Master_thesis", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.b16K4t4cKk/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "SHLVL": "1", "HOME": "/Users/victor", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-deleted file mode 100644
-index 341b94d..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-+++ /dev/null
-@@ -1,30 +0,0 @@
--diff --git a/expert_trajectories.npz b/expert_trajectories.npz
--index 6fd7b82..04a5abf 100644
--Binary files a/expert_trajectories.npz and b/expert_trajectories.npz differ
--diff --git a/main.py b/main.py
--index 60a144f..adf5222 100644
----- a/main.py
--+++ b/main.py
--@@ -19,12 +19,10 @@ def main(case = 'discrete_events'):
-- 
--     outdir = get_outdir(args.case, args.n_experts, n_categories=1)
-- 
---    n_experts = 1
---
--     demo_states = []
--     demo_actions = []
-- 
---    for i in range(n_experts):
--+    for i in range(args.n_experts):
--         usr = User(time_steps = 128)
--         states, actions = usr.generate_trajectory()
--         demo_states.append(states)
--@@ -33,7 +31,7 @@ def main(case = 'discrete_events'):
--     PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--     np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--              actions=np.array(demo_actions, dtype=object)) 
---    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--+    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01', '--outdir', outdir]
--     s = subprocess.Popen(command)
-- 
-- 
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-deleted file mode 100644
-index c32b34f..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-deleted file mode 100644
-index 4286080..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-+++ /dev/null
-@@ -1,205 +0,0 @@
--commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 15:08:07 2020 +0100
--
--    updated main
--
--commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:57:39 2020 +0100
--
--    main hej
--
--commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
--Merge: 551fe5f 8737870
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:50:41 2020 +0100
--
--    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
--
--commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:47:48 2020 +0100
--
--    fixed main
--
--commit 8737870c484cb6b62516b732984a5a89d49758c9
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 14:44:23 2020 +0100
--
--    added fcn define_case()
--
--commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 13:22:18 2020 +0100
--
--    hej
--
--commit 989a9ddbce8c70f8884960c940dff5cb85abe953
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 17:12:55 2020 +0100
--
--    bra skit
--
--commit fcf59768c112e2f710499a11a083ddbf926e90f1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:57:23 2020 +0100
--
--    fixed main
--
--commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:36:26 2020 +0100
--
--    installed configparser, created config.ini and main.py
--
--commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:23:36 2020 +0100
--
--    changed name of folders
--
--commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 15:48:33 2020 +0100
--
--    changed structure, added __init.py files
--
--commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:11:39 2020 +0100
--
--    changed structure
--
--commit 28daae8a8544c14b37f99e8726991791996ad55a
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:09:29 2020 +0100
--
--    Changed structure of repo
--
--commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 13:05:51 2020 +0100
--
--    updated code to get GAIL to run
--
--commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 10:41:03 2020 +0100
--
--    added results
--
--commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:56:40 2020 +0100
--
--    fin
--
--commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:43:09 2020 +0100
--
--    hgi
--
--commit faf34d5f495f4f5424279e5823d168af86fd7291
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:38:52 2020 +0100
--
--    fixed requirements.txt
--
--commit d0bbd5cabbc023ddc00945620543c56372367146
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:08:25 2020 +0100
--
--    added deepirl
--
--commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:06:32 2020 +0100
--
--    fixni
--
--commit 13215698e0d7d48d404df1075c540037bc470a59
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:00:49 2020 +0100
--
--    added files for custom_env
--
--commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 16:09:26 2020 +0100
--
--    fixed .npz file
--
--commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Tue Feb 4 16:08:32 2020 +0100
--
--    created env
--
--commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:54:48 2020 +0100
--
--    added traj
--
--commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
--Merge: 89e455b 585fa30
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:39:11 2020 +0100
--
--    gij
--
--commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:38:22 2020 +0100
--
--    gg
--
--commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:36:44 2020 +0100
--
--    changed in user class
--
--commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:19 2020 +0100
--
--    Delete gail_pendulum.zip
--
--commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:10 2020 +0100
--
--    Delete expert_pendulum.npz
--
--commit 5d83000b84635f517ffd723a2f47424e75a16f80
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 16:30:13 2020 +0100
--
--    feature extraction + plots changed
--
--commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 11:57:18 2020 +0100
--
--    added generate_data.py
--
--commit 216496211fab6141cd7fcc891228f8692350a3ff
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 08:41:26 2020 +0100
--
--    Tested different ways to compare time series
--
--commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Jan 21 15:17:48 2020 +0100
--
--    first commit
--
--commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Jan 20 09:53:42 2020 +0100
--
--    Initial commit
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-deleted file mode 100644
-index 953dca0..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-+++ /dev/null
-@@ -1,16 +0,0 @@
--On branch master
--Your branch is up to date with 'origin/master'.
--
--Changes not staged for commit:
--  (use "git add <file>..." to update what will be committed)
--  (use "git checkout -- <file>..." to discard changes in working directory)
--
--	modified:   expert_trajectories.npz
--	modified:   main.py
--
--Untracked files:
--  (use "git add <file>..." to include in what will be committed)
--
--	results/discrete_events/
--
--no changes added to commit (use "git add" and/or "git commit -a")
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-deleted file mode 100644
-index 99dfa5e..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-deleted file mode 100644
-index fc48d49..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz and /dev/null differ
-diff --git a/temp_main.py b/temp_main.py
-index a507968..d9be2ca 100644
---- a/temp_main.py
-+++ b/temp_main.py
-@@ -1,47 +1,331 @@
--from customer_behaviour.tools import dgm as dgm
--from customer_behaviour.tools.generate_data import User 
-+"""An example of training PPO against OpenAI Gym Envs.
-+
-+This script is an example of training a PPO agent against OpenAI Gym envs.
-+Both discrete and continuous action spaces are supported.
-+
-+To solve CartPole-v0, run:
-+    python train_ppo_gym.py --env CartPole-v0
-+"""
-+
-+import sys
- import os
-+import datetime
- import argparse
--import subprocess
--import numpy as np
-+from os.path import join
-+#sys.path.append(os.getcwd())
-+
-+
-+import gym
-+import custom_gym
-+import gym.wrappers
-+
-+import chainer
-+from chainer import functions as F
-+import chainerrl
-+
-+from chainerrl.agents import a3c
-+from chainerrl.agents import PPO
-+from chainerrl import experiments
-+from chainerrl import links
-+from chainerrl import misc
-+from chainerrl.optimizers.nonbias_weight_decay import NonbiasWeightDecay
-+from chainerrl import policies
-+
-+
-+class A3CFFSoftmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward softmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.SoftmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFMellowmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward mellowmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.MellowmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFGaussian(chainer.Chain, a3c.A3CModel):
-+    """An example of A3C feedforward Gaussian policy."""
-+
-+    def __init__(self, obs_size, action_space,
-+                 n_hidden_layers=2, n_hidden_channels=64,
-+                 bound_mean=None):
-+        assert bound_mean in [False, True]
-+        super().__init__()
-+        hidden_sizes = (n_hidden_channels,) * n_hidden_layers
-+        with self.init_scope():
-+            self.pi = policies.FCGaussianPolicyWithStateIndependentCovariance(
-+                obs_size, action_space.low.size,
-+                n_hidden_layers, n_hidden_channels,
-+                var_type='diagonal', nonlinearity=F.tanh,
-+                bound_mean=bound_mean,
-+                min_action=action_space.low, max_action=action_space.high,
-+                mean_wscale=1e-2)
-+            self.v = links.MLP(obs_size, 1, hidden_sizes=hidden_sizes)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+def save_agent_demo(env, agent, out_dir, max_t=2000):
-+    import numpy as np
-+    r, t = 0, 0
-+    agent_observations = []
-+    agent_actions = []
-+    while t < max_t:
-+        agent_observations.append([])
-+        agent_actions.append([])
-+        obs = env.reset()
-+        while True:
-+            act = agent.act(obs)
-+            agent_observations[-1].append(obs)
-+            agent_actions[-1].append(act)
-+            obs, reward, done, _ = env.step(act)
-+            t += 1
-+            r += reward
-+            if done or t >= max_t:
-+                print(t)
-+                break
-+
-+    # save numpy array consists of lists
-+    np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
-+             actions=np.array(agent_actions, dtype=object))
-+
-+def get_outdir(algo, case, n_experts, n_categories):
-+
-+    if not os.path.exists('results'): os.makedirs('results')
-+
-+    path = join('results', str(algo))
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, case)
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_experts) + '_expert(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_categories) + '_product(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-+    path = join(path, time)
-+
-+    return path
-+
-+
-+def get_env(case, n_experts):
-+    if case == 'discrete_events':
-+        env = 'discrete-buying-events-v0'
-+    elif case == 'full_receipt':
-+        env = ''
-+
-+    return env
-+
-+def str2bool(v):
-+    if isinstance(v, bool):
-+       return v
-+    if v.lower() in ('yes', 'True', 't', 'y', '1', 'true'):
-+        return True
-+    elif v.lower() in ('no', 'False', 'f', 'n', '0', 'false'):
-+        return False
-+    else:
-+        raise argparse.ArgumentTypeError('Boolean value expected.')
-+
-+
-+def main():
-+    import logging
- 
--def main(case = 'discrete_events'):
-     parser = argparse.ArgumentParser()
-     parser.add_argument('algo', default='gail', choices=['gail', 'airl'], type=str)
--    parser.add_argument('--case', type=str, default=case)
-+    parser.add_argument('--gpu', type=int, default=0)
-+    parser.add_argument('--case', type=str, default='discrete_events')
-     parser.add_argument('--n_experts', type=int, default=1)
--    parser.add_argument('--n_steps', type=int, default=10000)
-+    parser.add_argument('--n_categories', type=int, default=1)
-+    parser.add_argument('--seed_expert', type=str2bool, nargs='?',
-+                        const=True, default=False,
-+                        help="Activate nice mode.")
-+    parser.add_argument('--arch', type=str, default='FFSoftmax',
-+                        choices=('FFSoftmax', 'FFMellowmax',
-+                                 'FFGaussian'))
-+    parser.add_argument('--bound-mean', action='store_true')
-+    parser.add_argument('--seed', type=int, default=0,
-+                        help='Random seed [0, 2 ** 32)')
-+    #parser.add_argument('--outdir', type=str, default='results', help='Directory path to save output files.'' If it does not exist, it will be created.')
-+    parser.add_argument('--steps', type=int, default=10 ** 6)
-+    parser.add_argument('--eval-interval', type=int, default=10000)
-+    parser.add_argument('--eval-n-runs', type=int, default=10)
-+    parser.add_argument('--reward-scale-factor', type=float, default=1e-2)
-+    parser.add_argument('--standardize-advantages', action='store_true')
-+    parser.add_argument('--render', action='store_true', default=False)
-+    parser.add_argument('--lr', type=float, default=3e-4)
-+    parser.add_argument('--weight-decay', type=float, default=0.0)
-+    parser.add_argument('--demo', action='store_true', default=False)
-+    parser.add_argument('--load', type=str, default='')
-+    parser.add_argument('--load_demo', type=str, default='')
-+    parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
-+    parser.add_argument('--monitor', action='store_true')
-+
-+    parser.add_argument('--update-interval', type=int, default=128)
-+    parser.add_argument('--batchsize', type=int, default=64)
-+    parser.add_argument('--epochs', type=int, default=10)
-+    parser.add_argument('--entropy-coef', type=float, default=0.01)
-     args = parser.parse_args()
-+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-+    args.env = get_env(args.case, args.n_experts)
- 
--    env = find_env(args.case, args.n_experts)
-+    logging.basicConfig(level=args.logger_level)
- 
--    n_experts = 1
-+    # Set a random seed used in ChainerRL
-+    misc.set_random_seed(args.seed, gpus=(args.gpu,))
- 
--    demo_states = []
--    demo_actions = []
-+    if not (args.demo and args.load):
-+        args.outdir = experiments.prepare_output_dir(args, args.outdir)
- 
--    for i in range(n_experts):
--        usr = User(time_steps = 128)
--        states, actions = usr.generate_trajectory()
--        demo_states.append(states)
--        demo_actions.append(actions)
-+    def make_env(test):
-+        env = gym.make(args.env)
-+        env.define_case(0, 0, 7*[0])
- 
--    PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--    np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--             actions=np.array(demo_actions, dtype=object)) 
--    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--    s = subprocess.Popen(command)
-+        # Use different random seeds for train and test envs
-+        env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
-+        env.seed(env_seed)
-+        # Cast observations to float32 because our model uses float32
-+        env = chainerrl.wrappers.CastObservationToFloat32(env)
-+        if args.monitor:
-+            env = gym.wrappers.Monitor(env, args.outdir)
-+        if not test:
-+            # Scale rewards (and thus returns) to a reasonable range so that
-+            # training is easier
-+            env = chainerrl.wrappers.ScaleReward(env, args.reward_scale_factor)
-+        if args.render:
-+            env = chainerrl.wrappers.Render(env)
-+        return env
- 
--def find_env(case, n_experts):
--    if case == 'discrete_events':
--        if n_experts == 1:
--            env = 'discrete-buying-events-v0'
-+    sample_env = gym.make(args.env)
-+    sample_env.define_case(0, 0, 7*[0])
-+    timestep_limit = sample_env.spec.tags.get(
-+        'wrapper_config.TimeLimit.max_episode_steps')
-+    obs_space = sample_env.observation_space
-+    action_space = sample_env.action_space
- 
--    if case == 'full_receipt':
--        if n_experts == 1:
--            env = ''
-+    # Normalize observations based on their empirical mean and variance
- 
--    return env
-+    obs_normalizer = None                                                                # HarDKODAT
-+    #chainerrl.links.EmpiricalNormalization(obs_space.low.size, clip_threshold=5)
-+
-+    # Switch policy types accordingly to action space types
-+    if args.arch == 'FFSoftmax':
-+        model = A3CFFSoftmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFMellowmax':
-+        model = A3CFFMellowmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFGaussian':
-+        model = A3CFFGaussian(obs_space.low.size, action_space,
-+                              bound_mean=args.bound_mean)
-+
-+    opt = chainer.optimizers.Adam(alpha=args.lr, eps=1e-5)
-+    opt.setup(model)
-+    if args.weight_decay > 0:
-+        opt.add_hook(NonbiasWeightDecay(args.weight_decay))
-+    if args.algo == 'ppo':
-+        agent = PPO(model, opt,
-+                    obs_normalizer=obs_normalizer,
-+                    gpu=args.gpu,
-+                    update_interval=args.update_interval,
-+                    minibatch_size=args.batchsize, epochs=args.epochs,
-+                    clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                    standardize_advantages=args.standardize_advantages,
-+                    )
-+    elif args.algo == 'gail':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.gail import GAIL
-+        from customer_behaviour.algorithms.irl.gail import Discriminator
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = GAIL(demonstrations=demonstrations, discriminator=D,
-+                     model=model, optimizer=opt,
-+                     obs_normalizer=obs_normalizer,
-+                     gpu=args.gpu,
-+                     update_interval=args.update_interval,
-+                     minibatch_size=args.batchsize, epochs=args.epochs,
-+                     clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                     standardize_advantages=args.standardize_advantages,)
-+    elif args.algo == 'airl':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.airl import AIRL as Agent
-+        from customer_behaviour.algorithms.irl.airl import Discriminator
-+        # obs_normalizer = None
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = Agent(demonstrations=demonstrations, discriminator=D,
-+                      model=model, optimizer=opt,
-+                      obs_normalizer=obs_normalizer,
-+                      gpu=args.gpu,
-+                      update_interval=args.update_interval,
-+                      minibatch_size=args.batchsize, epochs=args.epochs,
-+                      clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                      standardize_advantages=args.standardize_advantages,)
-+
-+    if args.load:
-+        agent.load(args.load)
-+
-+    if args.demo:
-+        env = make_env(True)
-+        eval_stats = experiments.eval_performance(
-+            env=env,
-+            agent=agent,
-+            n_steps=None,
-+            n_episodes=args.eval_n_runs,
-+            max_episode_len=timestep_limit)
-+        print('n_runs: {} mean: {} median: {} stdev {}'.format(
-+            args.eval_n_runs, eval_stats['mean'], eval_stats['median'],
-+            eval_stats['stdev']))
-+        outdir = args.load if args.load else args.outdir
-+        save_agent_demo(make_env(False), agent, outdir)
-+    else:
-+        # Linearly decay the learning rate to zero
-+        def lr_setter(env, agent, value):
-+            agent.optimizer.alpha = value
-+
-+        lr_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, args.lr, 0, lr_setter)
-+
-+        # Linearly decay the clipping parameter to zero
-+        def clip_eps_setter(env, agent, value):
-+            agent.clip_eps = max(value, 1e-8)
-+
-+        clip_eps_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, 0.2, 0, clip_eps_setter)
-+
-+        experiments.train_agent_with_evaluation(
-+            agent=agent,
-+            env=make_env(False),
-+            eval_env=make_env(True),
-+            outdir=args.outdir,
-+            steps=args.steps,
-+            eval_n_steps=None,
-+            eval_n_episodes=args.eval_n_runs,
-+            eval_interval=args.eval_interval,
-+            train_max_episode_len=timestep_limit,
-+            save_best_so_far_agent=False,
-+            step_hooks=[
-+                lr_decay_hook,
-+                clip_eps_decay_hook,
-+            ],
-+        )
-+        save_agent_demo(make_env(False), agent, args.outdir)
- 
- 
- if __name__ == '__main__':
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-head.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-head.txt
deleted file mode 100644
index ed95f27..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-head.txt
+++ /dev/null
@@ -1 +0,0 @@
-92fa4b893bc749ddaa3a3d107d383d7ad35748f5
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-log.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-log.txt
deleted file mode 100644
index a91c7dc..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-log.txt
+++ /dev/null
@@ -1,211 +0,0 @@
-commit 92fa4b893bc749ddaa3a3d107d383d7ad35748f5
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Mon Feb 10 08:44:27 2020 +0100
-
-    kfj
-
-commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 15:08:07 2020 +0100
-
-    updated main
-
-commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:57:39 2020 +0100
-
-    main hej
-
-commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
-Merge: 551fe5f 8737870
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:50:41 2020 +0100
-
-    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
-
-commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:47:48 2020 +0100
-
-    fixed main
-
-commit 8737870c484cb6b62516b732984a5a89d49758c9
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 14:44:23 2020 +0100
-
-    added fcn define_case()
-
-commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 13:22:18 2020 +0100
-
-    hej
-
-commit 989a9ddbce8c70f8884960c940dff5cb85abe953
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 17:12:55 2020 +0100
-
-    bra skit
-
-commit fcf59768c112e2f710499a11a083ddbf926e90f1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:57:23 2020 +0100
-
-    fixed main
-
-commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:36:26 2020 +0100
-
-    installed configparser, created config.ini and main.py
-
-commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:23:36 2020 +0100
-
-    changed name of folders
-
-commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 15:48:33 2020 +0100
-
-    changed structure, added __init.py files
-
-commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:11:39 2020 +0100
-
-    changed structure
-
-commit 28daae8a8544c14b37f99e8726991791996ad55a
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:09:29 2020 +0100
-
-    Changed structure of repo
-
-commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 13:05:51 2020 +0100
-
-    updated code to get GAIL to run
-
-commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 10:41:03 2020 +0100
-
-    added results
-
-commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:56:40 2020 +0100
-
-    fin
-
-commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:43:09 2020 +0100
-
-    hgi
-
-commit faf34d5f495f4f5424279e5823d168af86fd7291
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:38:52 2020 +0100
-
-    fixed requirements.txt
-
-commit d0bbd5cabbc023ddc00945620543c56372367146
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:08:25 2020 +0100
-
-    added deepirl
-
-commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:06:32 2020 +0100
-
-    fixni
-
-commit 13215698e0d7d48d404df1075c540037bc470a59
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:00:49 2020 +0100
-
-    added files for custom_env
-
-commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 16:09:26 2020 +0100
-
-    fixed .npz file
-
-commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Tue Feb 4 16:08:32 2020 +0100
-
-    created env
-
-commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:54:48 2020 +0100
-
-    added traj
-
-commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
-Merge: 89e455b 585fa30
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:39:11 2020 +0100
-
-    gij
-
-commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:38:22 2020 +0100
-
-    gg
-
-commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:36:44 2020 +0100
-
-    changed in user class
-
-commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:19 2020 +0100
-
-    Delete gail_pendulum.zip
-
-commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:10 2020 +0100
-
-    Delete expert_pendulum.npz
-
-commit 5d83000b84635f517ffd723a2f47424e75a16f80
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 16:30:13 2020 +0100
-
-    feature extraction + plots changed
-
-commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 11:57:18 2020 +0100
-
-    added generate_data.py
-
-commit 216496211fab6141cd7fcc891228f8692350a3ff
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 08:41:26 2020 +0100
-
-    Tested different ways to compare time series
-
-commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Jan 21 15:17:48 2020 +0100
-
-    first commit
-
-commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Jan 20 09:53:42 2020 +0100
-
-    Initial commit
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-status.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-status.txt
deleted file mode 100644
index bba909f..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/git-status.txt
+++ /dev/null
@@ -1,30 +0,0 @@
-On branch master
-Your branch is up to date with 'origin/master'.
-
-Changes not staged for commit:
-  (use "git add/rm <file>..." to update what will be committed)
-  (use "git checkout -- <file>..." to discard changes in working directory)
-
-	deleted:    config.ini
-	modified:   customer_behaviour/algorithms/irl/airl/discriminator.py
-	modified:   customer_behaviour/algorithms/irl/common/utils/__init__.py
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-	modified:   temp_main.py
-
-Untracked files:
-  (use "git add <file>..." to include in what will be committed)
-
-	results/airl/
-	results/gail/
-
-no changes added to commit (use "git add" and/or "git commit -a")
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/scores.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/scores.txt
deleted file mode 100644
index 3f8062a..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/scores.txt
+++ /dev/null
@@ -1 +0,0 @@
-steps	episodes	elapsed	mean	median	stdev	max	min	average_value	average_entropy	average_value_loss	average_policy_loss
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/trajectories.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/trajectories.npz
deleted file mode 100644
index fc48d49..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_09-52-24/20200210T095224.021905/trajectories.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/10_finish/model.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/10_finish/model.npz
deleted file mode 100644
index b3d88e6..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/10_finish/model.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/10_finish/optimizer.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/10_finish/optimizer.npz
deleted file mode 100644
index eecd553..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/10_finish/optimizer.npz and /dev/null differ
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/args.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/args.txt
deleted file mode 100644
index 399bddd..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/args.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"algo": "gail", "gpu": -1, "case": "discrete_events", "n_experts": 1, "n_categories": 1, "seed_expert": true, "n_historic_events": 10, "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01, "outdir": "results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58", "env": "discrete-buying-events-v0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/command.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/command.txt
deleted file mode 100644
index a24313f..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/command.txt
+++ /dev/null
@@ -1 +0,0 @@
-temp_main.py gail --gpu -1 --case discrete_events --n_experts 1 --n_categories 1 --n_historic_events 10 --steps 10 --seed_expert True --load_demo expert_trajectories.npz
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/environ.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/environ.txt
deleted file mode 100644
index 9c1bbd9..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/environ.txt
+++ /dev/null
@@ -1 +0,0 @@
-{"TERM_PROGRAM": "Apple_Terminal", "TERM": "xterm-256color", "SHELL": "/bin/bash", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.gjMnJvQ4ux/Render", "TERM_PROGRAM_VERSION": "421.2", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.4I4GqXIb2y/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "HOME": "/Users/victor", "SHLVL": "1", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
\ No newline at end of file
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-diff.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-diff.txt
deleted file mode 100644
index 1cf20c2..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-diff.txt
+++ /dev/null
@@ -1,723 +0,0 @@
-diff --git a/config.ini b/config.ini
-deleted file mode 100644
-index 0b70f3c..0000000
---- a/config.ini
-+++ /dev/null
-@@ -1,11 +0,0 @@
--[DEFAULT]
--
--
--[discrete_events]
--N_EXPERTS = 1
--N_PRODUCTS = 1
--
--[full_receipts]
--N_EXPERTS = 1
--N_PRODUCTS = 6
--
-diff --git a/customer_behaviour/algorithms/irl/airl/discriminator.py b/customer_behaviour/algorithms/irl/airl/discriminator.py
-index 931e98e..cdc5c9d 100755
---- a/customer_behaviour/algorithms/irl/airl/discriminator.py
-+++ b/customer_behaviour/algorithms/irl/airl/discriminator.py
-@@ -1,6 +1,6 @@
- import chainer
- import chainer.functions as F
--from irl.common.model import MLP
-+from customer_behaviour.algorithms.irl.common.model import MLP
- from chainer.link_hooks.spectral_normalization import SpectralNormalization
- 
- 
-diff --git a/customer_behaviour/algorithms/irl/common/utils/__init__.py b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-index f808b8c..2c9d8c4 100755
---- a/customer_behaviour/algorithms/irl/common/utils/__init__.py
-+++ b/customer_behaviour/algorithms/irl/common/utils/__init__.py
-@@ -1 +1 @@
--from irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-+from customer_behaviour.algorithms.irl.common.utils.get_states_actions_next_states import get_states_actions_next_states
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-deleted file mode 100644
-index f0dec34..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-deleted file mode 100644
-index eecd553..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz and /dev/null differ
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-deleted file mode 100644
-index c122e59..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"algo": "airl", "gpu": -1, "env": "discrete-buying-events-v0", "arch": "FFSoftmax", "bound_mean": false, "seed": 0, "outdir": "results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43", "steps": 10, "eval_interval": 10000, "eval_n_runs": 10, "reward_scale_factor": 0.01, "standardize_advantages": false, "render": false, "lr": 0.0003, "weight_decay": 0.0, "demo": false, "load": "", "load_demo": "expert_trajectories.npz", "logger_level": 10, "monitor": false, "update_interval": 128, "batchsize": 64, "epochs": 10, "entropy_coef": 0.01}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-deleted file mode 100644
-index 913e5b6..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--customer_behaviour/algorithms/train_gym.py airl --gpu -1 --env discrete-buying-events-v0 --arch FFSoftmax --steps 10 --load_demo expert_trajectories.npz --update-interval 128 --entropy-coef 0.01 --outdir results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-deleted file mode 100644
-index ef43d43..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--{"TERM_PROGRAM": "Apple_Terminal", "SHELL": "/bin/bash", "TERM": "xterm-256color", "TMPDIR": "/var/folders/4f/g74qw9y51r93c421krm02s240000gn/T/", "Apple_PubSub_Socket_Render": "/private/tmp/com.apple.launchd.JuAPseFAEM/Render", "TERM_PROGRAM_VERSION": "421.2", "OLDPWD": "/Users/victor/Documents/CAS_2/Master_thesis", "TERM_SESSION_ID": "FE64D9D1-EF2D-4EC8-A11B-B54771F0289B", "USER": "victor", "SSH_AUTH_SOCK": "/private/tmp/com.apple.launchd.b16K4t4cKk/Listeners", "VIRTUAL_ENV": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv", "PATH": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin:/usr/local/sbin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.4/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin", "PWD": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour", "XPC_FLAGS": "0x0", "PS1": "(venv) \\h:\\W \\u\\$ ", "XPC_SERVICE_NAME": "0", "SHLVL": "1", "HOME": "/Users/victor", "LOGNAME": "victor", "LC_CTYPE": "UTF-8", "SECURITYSESSIONID": "186a7", "_": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "__CF_USER_TEXT_ENCODING": "0x1F5:0x0:0x0", "__PYVENV_LAUNCHER__": "/Users/victor/Documents/CAS_2/Master_thesis/CustomerBehaviour/venv/bin/python", "CHAINER_SEED": "0"}
-\ No newline at end of file
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-deleted file mode 100644
-index 341b94d..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-+++ /dev/null
-@@ -1,30 +0,0 @@
--diff --git a/expert_trajectories.npz b/expert_trajectories.npz
--index 6fd7b82..04a5abf 100644
--Binary files a/expert_trajectories.npz and b/expert_trajectories.npz differ
--diff --git a/main.py b/main.py
--index 60a144f..adf5222 100644
----- a/main.py
--+++ b/main.py
--@@ -19,12 +19,10 @@ def main(case = 'discrete_events'):
-- 
--     outdir = get_outdir(args.case, args.n_experts, n_categories=1)
-- 
---    n_experts = 1
---
--     demo_states = []
--     demo_actions = []
-- 
---    for i in range(n_experts):
--+    for i in range(args.n_experts):
--         usr = User(time_steps = 128)
--         states, actions = usr.generate_trajectory()
--         demo_states.append(states)
--@@ -33,7 +31,7 @@ def main(case = 'discrete_events'):
--     PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--     np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--              actions=np.array(demo_actions, dtype=object)) 
---    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--+    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01', '--outdir', outdir]
--     s = subprocess.Popen(command)
-- 
-- 
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-deleted file mode 100644
-index c32b34f..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-deleted file mode 100644
-index 4286080..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-+++ /dev/null
-@@ -1,205 +0,0 @@
--commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 15:08:07 2020 +0100
--
--    updated main
--
--commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:57:39 2020 +0100
--
--    main hej
--
--commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
--Merge: 551fe5f 8737870
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:50:41 2020 +0100
--
--    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
--
--commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 14:47:48 2020 +0100
--
--    fixed main
--
--commit 8737870c484cb6b62516b732984a5a89d49758c9
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Fri Feb 7 14:44:23 2020 +0100
--
--    added fcn define_case()
--
--commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Fri Feb 7 13:22:18 2020 +0100
--
--    hej
--
--commit 989a9ddbce8c70f8884960c940dff5cb85abe953
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 17:12:55 2020 +0100
--
--    bra skit
--
--commit fcf59768c112e2f710499a11a083ddbf926e90f1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:57:23 2020 +0100
--
--    fixed main
--
--commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:36:26 2020 +0100
--
--    installed configparser, created config.ini and main.py
--
--commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 16:23:36 2020 +0100
--
--    changed name of folders
--
--commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 15:48:33 2020 +0100
--
--    changed structure, added __init.py files
--
--commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:11:39 2020 +0100
--
--    changed structure
--
--commit 28daae8a8544c14b37f99e8726991791996ad55a
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Feb 6 14:09:29 2020 +0100
--
--    Changed structure of repo
--
--commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
--Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
--Date:   Thu Feb 6 13:05:51 2020 +0100
--
--    updated code to get GAIL to run
--
--commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 10:41:03 2020 +0100
--
--    added results
--
--commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:56:40 2020 +0100
--
--    fin
--
--commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:43:09 2020 +0100
--
--    hgi
--
--commit faf34d5f495f4f5424279e5823d168af86fd7291
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:38:52 2020 +0100
--
--    fixed requirements.txt
--
--commit d0bbd5cabbc023ddc00945620543c56372367146
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:08:25 2020 +0100
--
--    added deepirl
--
--commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:06:32 2020 +0100
--
--    fixni
--
--commit 13215698e0d7d48d404df1075c540037bc470a59
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Wed Feb 5 09:00:49 2020 +0100
--
--    added files for custom_env
--
--commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 16:09:26 2020 +0100
--
--    fixed .npz file
--
--commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
--Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
--Date:   Tue Feb 4 16:08:32 2020 +0100
--
--    created env
--
--commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:54:48 2020 +0100
--
--    added traj
--
--commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
--Merge: 89e455b 585fa30
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:39:11 2020 +0100
--
--    gij
--
--commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:38:22 2020 +0100
--
--    gg
--
--commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Feb 4 13:36:44 2020 +0100
--
--    changed in user class
--
--commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:19 2020 +0100
--
--    Delete gail_pendulum.zip
--
--commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Feb 3 14:15:10 2020 +0100
--
--    Delete expert_pendulum.npz
--
--commit 5d83000b84635f517ffd723a2f47424e75a16f80
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 16:30:13 2020 +0100
--
--    feature extraction + plots changed
--
--commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 11:57:18 2020 +0100
--
--    added generate_data.py
--
--commit 216496211fab6141cd7fcc891228f8692350a3ff
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Thu Jan 30 08:41:26 2020 +0100
--
--    Tested different ways to compare time series
--
--commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
--Author: VictorGardi <victor.olssn@gmail.com>
--Date:   Tue Jan 21 15:17:48 2020 +0100
--
--    first commit
--
--commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
--Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
--Date:   Mon Jan 20 09:53:42 2020 +0100
--
--    Initial commit
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-deleted file mode 100644
-index 953dca0..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-+++ /dev/null
-@@ -1,16 +0,0 @@
--On branch master
--Your branch is up to date with 'origin/master'.
--
--Changes not staged for commit:
--  (use "git add <file>..." to update what will be committed)
--  (use "git checkout -- <file>..." to discard changes in working directory)
--
--	modified:   expert_trajectories.npz
--	modified:   main.py
--
--Untracked files:
--  (use "git add <file>..." to include in what will be committed)
--
--	results/discrete_events/
--
--no changes added to commit (use "git add" and/or "git commit -a")
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-deleted file mode 100644
-index 99dfa5e..0000000
---- a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-+++ /dev/null
-@@ -1 +0,0 @@
--steps	episodes	elapsed	mean	median	stdev	max	min	average_discriminator_loss	average_rewards	average_value	average_entropy	average_value_loss	average_policy_loss
-diff --git a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz b/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-deleted file mode 100644
-index fc48d49..0000000
-Binary files a/results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz and /dev/null differ
-diff --git a/temp_main.py b/temp_main.py
-index a507968..daf5b3b 100644
---- a/temp_main.py
-+++ b/temp_main.py
-@@ -1,47 +1,332 @@
--from customer_behaviour.tools import dgm as dgm
--from customer_behaviour.tools.generate_data import User 
-+"""An example of training PPO against OpenAI Gym Envs.
-+
-+This script is an example of training a PPO agent against OpenAI Gym envs.
-+Both discrete and continuous action spaces are supported.
-+
-+To solve CartPole-v0, run:
-+    python train_ppo_gym.py --env CartPole-v0
-+"""
-+
-+import sys
- import os
-+import datetime
- import argparse
--import subprocess
--import numpy as np
-+from os.path import join
-+#sys.path.append(os.getcwd())
-+
-+
-+import gym
-+import custom_gym
-+import gym.wrappers
-+
-+import chainer
-+from chainer import functions as F
-+import chainerrl
-+
-+from chainerrl.agents import a3c
-+from chainerrl.agents import PPO
-+from chainerrl import experiments
-+from chainerrl import links
-+from chainerrl import misc
-+from chainerrl.optimizers.nonbias_weight_decay import NonbiasWeightDecay
-+from chainerrl import policies
-+
-+
-+class A3CFFSoftmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward softmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.SoftmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFMellowmax(chainer.ChainList, a3c.A3CModel):
-+    """An example of A3C feedforward mellowmax policy."""
-+
-+    def __init__(self, ndim_obs, n_actions, hidden_sizes=(200, 200)):
-+        self.pi = policies.MellowmaxPolicy(
-+            model=links.MLP(ndim_obs, n_actions, hidden_sizes))
-+        self.v = links.MLP(ndim_obs, 1, hidden_sizes=hidden_sizes)
-+        super().__init__(self.pi, self.v)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+class A3CFFGaussian(chainer.Chain, a3c.A3CModel):
-+    """An example of A3C feedforward Gaussian policy."""
-+
-+    def __init__(self, obs_size, action_space,
-+                 n_hidden_layers=2, n_hidden_channels=64,
-+                 bound_mean=None):
-+        assert bound_mean in [False, True]
-+        super().__init__()
-+        hidden_sizes = (n_hidden_channels,) * n_hidden_layers
-+        with self.init_scope():
-+            self.pi = policies.FCGaussianPolicyWithStateIndependentCovariance(
-+                obs_size, action_space.low.size,
-+                n_hidden_layers, n_hidden_channels,
-+                var_type='diagonal', nonlinearity=F.tanh,
-+                bound_mean=bound_mean,
-+                min_action=action_space.low, max_action=action_space.high,
-+                mean_wscale=1e-2)
-+            self.v = links.MLP(obs_size, 1, hidden_sizes=hidden_sizes)
-+
-+    def pi_and_v(self, state):
-+        return self.pi(state), self.v(state)
-+
-+
-+def save_agent_demo(env, agent, out_dir, max_t=2000):
-+    import numpy as np
-+    r, t = 0, 0
-+    agent_observations = []
-+    agent_actions = []
-+    while t < max_t:
-+        agent_observations.append([])
-+        agent_actions.append([])
-+        obs = env.reset()
-+        while True:
-+            act = agent.act(obs)
-+            agent_observations[-1].append(obs)
-+            agent_actions[-1].append(act)
-+            obs, reward, done, _ = env.step(act)
-+            t += 1
-+            r += reward
-+            if done or t >= max_t:
-+                print(t)
-+                break
-+
-+    # save numpy array consists of lists
-+    np.savez(out_dir+'/trajectories.npz', states=np.array(agent_observations, dtype=object),
-+             actions=np.array(agent_actions, dtype=object))
-+
-+def get_outdir(algo, case, n_experts, n_categories):
-+
-+    if not os.path.exists('results'): os.makedirs('results')
-+
-+    path = join('results', str(algo))
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, case)
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_experts) + '_expert(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    path = join(path, str(n_categories) + '_product(s)')
-+    if not os.path.exists(path): os.makedirs(path)
-+
-+    time = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
-+    path = join(path, time)
-+
-+    return path
-+
-+
-+def get_env(case, n_experts):
-+    if case == 'discrete_events':
-+        env = 'discrete-buying-events-v0'
-+    elif case == 'full_receipt':
-+        env = ''
-+
-+    return env
-+
-+def str2bool(v):
-+    if isinstance(v, bool):
-+       return v
-+    if v.lower() in ('yes', 'True', 't', 'y', '1', 'true'):
-+        return True
-+    elif v.lower() in ('no', 'False', 'f', 'n', '0', 'false'):
-+        return False
-+    else:
-+        raise argparse.ArgumentTypeError('Boolean value expected.')
-+
-+
-+def main():
-+    import logging
- 
--def main(case = 'discrete_events'):
-     parser = argparse.ArgumentParser()
-     parser.add_argument('algo', default='gail', choices=['gail', 'airl'], type=str)
--    parser.add_argument('--case', type=str, default=case)
-+    parser.add_argument('--gpu', type=int, default=0)
-+    parser.add_argument('--case', type=str, default='discrete_events')
-     parser.add_argument('--n_experts', type=int, default=1)
--    parser.add_argument('--n_steps', type=int, default=10000)
-+    parser.add_argument('--n_categories', type=int, default=1)
-+    parser.add_argument('--seed_expert', type=str2bool, nargs='?',
-+                        const=True, default=False,
-+                        help="Activate nice mode.")
-+    parser.add_argument('--n_historic_events', type=int, default=20)
-+    parser.add_argument('--arch', type=str, default='FFSoftmax',
-+                        choices=('FFSoftmax', 'FFMellowmax',
-+                                 'FFGaussian'))
-+    parser.add_argument('--bound-mean', action='store_true')
-+    parser.add_argument('--seed', type=int, default=0,
-+                        help='Random seed [0, 2 ** 32)')
-+    #parser.add_argument('--outdir', type=str, default='results', help='Directory path to save output files.'' If it does not exist, it will be created.')
-+    parser.add_argument('--steps', type=int, default=10 ** 6)
-+    parser.add_argument('--eval-interval', type=int, default=10000)
-+    parser.add_argument('--eval-n-runs', type=int, default=10)
-+    parser.add_argument('--reward-scale-factor', type=float, default=1e-2)
-+    parser.add_argument('--standardize-advantages', action='store_true')
-+    parser.add_argument('--render', action='store_true', default=False)
-+    parser.add_argument('--lr', type=float, default=3e-4)
-+    parser.add_argument('--weight-decay', type=float, default=0.0)
-+    parser.add_argument('--demo', action='store_true', default=False)
-+    parser.add_argument('--load', type=str, default='')
-+    parser.add_argument('--load_demo', type=str, default='')
-+    parser.add_argument('--logger-level', type=int, default=logging.DEBUG)
-+    parser.add_argument('--monitor', action='store_true')
-+    parser.add_argument('--update-interval', type=int, default=128)
-+    parser.add_argument('--batchsize', type=int, default=64)
-+    parser.add_argument('--epochs', type=int, default=10)
-+    parser.add_argument('--entropy-coef', type=float, default=0.01)
-     args = parser.parse_args()
-+    args.outdir = get_outdir(args.algo, args.case, args.n_experts, args.n_categories)
-+    args.env = get_env(args.case, args.n_experts)
-+    print(args.seed_expert)
- 
--    env = find_env(args.case, args.n_experts)
-+    logging.basicConfig(level=args.logger_level)
- 
--    n_experts = 1
-+    # Set a random seed used in ChainerRL
-+    misc.set_random_seed(args.seed, gpus=(args.gpu,))
- 
--    demo_states = []
--    demo_actions = []
-+    if not (args.demo and args.load):
-+        args.outdir = experiments.prepare_output_dir(args, args.outdir)
- 
--    for i in range(n_experts):
--        usr = User(time_steps = 128)
--        states, actions = usr.generate_trajectory()
--        demo_states.append(states)
--        demo_actions.append(actions)
-+    def make_env(test):
-+        env = gym.make(args.env)
-+        env.define_case(0, 0, 7*[0])
- 
--    PathOfDemonstrationNpzFile = os.getcwd() + '/expert_trajectories.npz'
--    np.savez(PathOfDemonstrationNpzFile, states=np.array(demo_states, dtype=object),
--             actions=np.array(demo_actions, dtype=object)) 
--    command = ['python', 'customer_behaviour/algorithms/train_gym.py', args.algo, '--gpu', '-1', '--env', env, '--arch', 'FFSoftmax', '--steps', str(args.n_steps), '--load_demo', 'expert_trajectories.npz', '--update-interval', '128', '--entropy-coef' ,'0.01']
--    s = subprocess.Popen(command)
-+        # Use different random seeds for train and test envs
-+        env_seed = 2 ** 32 - 1 - args.seed if test else args.seed
-+        env.seed(env_seed)
-+        # Cast observations to float32 because our model uses float32
-+        env = chainerrl.wrappers.CastObservationToFloat32(env)
-+        if args.monitor:
-+            env = gym.wrappers.Monitor(env, args.outdir)
-+        if not test:
-+            # Scale rewards (and thus returns) to a reasonable range so that
-+            # training is easier
-+            env = chainerrl.wrappers.ScaleReward(env, args.reward_scale_factor)
-+        if args.render:
-+            env = chainerrl.wrappers.Render(env)
-+        return env
- 
--def find_env(case, n_experts):
--    if case == 'discrete_events':
--        if n_experts == 1:
--            env = 'discrete-buying-events-v0'
-+    sample_env = gym.make(args.env)
-+    sample_env.define_case(0, 0, 7*[0])
-+    timestep_limit = sample_env.spec.tags.get(
-+        'wrapper_config.TimeLimit.max_episode_steps')
-+    obs_space = sample_env.observation_space
-+    action_space = sample_env.action_space
- 
--    if case == 'full_receipt':
--        if n_experts == 1:
--            env = ''
-+    # Normalize observations based on their empirical mean and variance
- 
--    return env
-+    obs_normalizer = None                                                                # HarDKODAT
-+    #chainerrl.links.EmpiricalNormalization(obs_space.low.size, clip_threshold=5)
-+
-+    # Switch policy types accordingly to action space types
-+    if args.arch == 'FFSoftmax':
-+        model = A3CFFSoftmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFMellowmax':
-+        model = A3CFFMellowmax(obs_space.low.size, action_space.n)
-+    elif args.arch == 'FFGaussian':
-+        model = A3CFFGaussian(obs_space.low.size, action_space,
-+                              bound_mean=args.bound_mean)
-+
-+    opt = chainer.optimizers.Adam(alpha=args.lr, eps=1e-5)
-+    opt.setup(model)
-+    if args.weight_decay > 0:
-+        opt.add_hook(NonbiasWeightDecay(args.weight_decay))
-+    if args.algo == 'ppo':
-+        agent = PPO(model, opt,
-+                    obs_normalizer=obs_normalizer,
-+                    gpu=args.gpu,
-+                    update_interval=args.update_interval,
-+                    minibatch_size=args.batchsize, epochs=args.epochs,
-+                    clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                    standardize_advantages=args.standardize_advantages,
-+                    )
-+    elif args.algo == 'gail':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.gail import GAIL
-+        from customer_behaviour.algorithms.irl.gail import Discriminator
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = GAIL(demonstrations=demonstrations, discriminator=D,
-+                     model=model, optimizer=opt,
-+                     obs_normalizer=obs_normalizer,
-+                     gpu=args.gpu,
-+                     update_interval=args.update_interval,
-+                     minibatch_size=args.batchsize, epochs=args.epochs,
-+                     clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                     standardize_advantages=args.standardize_advantages,)
-+    elif args.algo == 'airl':
-+        import numpy as np
-+        from customer_behaviour.algorithms.irl.airl import AIRL as Agent
-+        from customer_behaviour.algorithms.irl.airl import Discriminator
-+        # obs_normalizer = None
-+        demonstrations = np.load(args.load_demo)
-+        D = Discriminator(gpu=args.gpu)
-+        agent = Agent(demonstrations=demonstrations, discriminator=D,
-+                      model=model, optimizer=opt,
-+                      obs_normalizer=obs_normalizer,
-+                      gpu=args.gpu,
-+                      update_interval=args.update_interval,
-+                      minibatch_size=args.batchsize, epochs=args.epochs,
-+                      clip_eps_vf=None, entropy_coef=args.entropy_coef,
-+                      standardize_advantages=args.standardize_advantages,)
-+
-+    if args.load:
-+        agent.load(args.load)
-+
-+    if args.demo:
-+        env = make_env(True)
-+        eval_stats = experiments.eval_performance(
-+            env=env,
-+            agent=agent,
-+            n_steps=None,
-+            n_episodes=args.eval_n_runs,
-+            max_episode_len=timestep_limit)
-+        print('n_runs: {} mean: {} median: {} stdev {}'.format(
-+            args.eval_n_runs, eval_stats['mean'], eval_stats['median'],
-+            eval_stats['stdev']))
-+        outdir = args.load if args.load else args.outdir
-+        save_agent_demo(make_env(False), agent, outdir)
-+    else:
-+        # Linearly decay the learning rate to zero
-+        def lr_setter(env, agent, value):
-+            agent.optimizer.alpha = value
-+
-+        lr_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, args.lr, 0, lr_setter)
-+
-+        # Linearly decay the clipping parameter to zero
-+        def clip_eps_setter(env, agent, value):
-+            agent.clip_eps = max(value, 1e-8)
-+
-+        clip_eps_decay_hook = experiments.LinearInterpolationHook(
-+            args.steps, 0.2, 0, clip_eps_setter)
-+
-+        experiments.train_agent_with_evaluation(
-+            agent=agent,
-+            env=make_env(False),
-+            eval_env=make_env(True),
-+            outdir=args.outdir,
-+            steps=args.steps,
-+            eval_n_steps=None,
-+            eval_n_episodes=args.eval_n_runs,
-+            eval_interval=args.eval_interval,
-+            train_max_episode_len=timestep_limit,
-+            save_best_so_far_agent=False,
-+            step_hooks=[
-+                lr_decay_hook,
-+                clip_eps_decay_hook,
-+            ],
-+        )
-+        save_agent_demo(make_env(False), agent, args.outdir)
- 
- 
- if __name__ == '__main__':
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-head.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-head.txt
deleted file mode 100644
index ed95f27..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-head.txt
+++ /dev/null
@@ -1 +0,0 @@
-92fa4b893bc749ddaa3a3d107d383d7ad35748f5
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-log.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-log.txt
deleted file mode 100644
index a91c7dc..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-log.txt
+++ /dev/null
@@ -1,211 +0,0 @@
-commit 92fa4b893bc749ddaa3a3d107d383d7ad35748f5
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Mon Feb 10 08:44:27 2020 +0100
-
-    kfj
-
-commit f4075f2a842d9dd1f4ea1f72b9f66179e7b3ae8a
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 15:08:07 2020 +0100
-
-    updated main
-
-commit 64c77e6c83cb38a134a2bcce169dd065a5d32082
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:57:39 2020 +0100
-
-    main hej
-
-commit fecbf304c9cc4e49d57bd1a0039e40a06a17de4c
-Merge: 551fe5f 8737870
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:50:41 2020 +0100
-
-    Merge branch 'master' of https://github.com/VictorGardi/CustomerBehaviour
-
-commit 551fe5fd9d3792cfff136e0cb883dc61df3ecb5f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 14:47:48 2020 +0100
-
-    fixed main
-
-commit 8737870c484cb6b62516b732984a5a89d49758c9
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Fri Feb 7 14:44:23 2020 +0100
-
-    added fcn define_case()
-
-commit 2f8da159719fe2c35702c592f4655e6df90d9b3f
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Fri Feb 7 13:22:18 2020 +0100
-
-    hej
-
-commit 989a9ddbce8c70f8884960c940dff5cb85abe953
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 17:12:55 2020 +0100
-
-    bra skit
-
-commit fcf59768c112e2f710499a11a083ddbf926e90f1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:57:23 2020 +0100
-
-    fixed main
-
-commit 2cc2cd4d73f7f2e80f9d3e156a29757733d96610
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:36:26 2020 +0100
-
-    installed configparser, created config.ini and main.py
-
-commit 296e21d5f46eef31dba2e67cda3f2c214dd28235
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 16:23:36 2020 +0100
-
-    changed name of folders
-
-commit d3d68c49f46ba1486ad7a4eb5abadc03fb1c8089
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 15:48:33 2020 +0100
-
-    changed structure, added __init.py files
-
-commit 77f883b8a67c56c6e2b1e6b6cc6f1ee085f4f1ac
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:11:39 2020 +0100
-
-    changed structure
-
-commit 28daae8a8544c14b37f99e8726991791996ad55a
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Feb 6 14:09:29 2020 +0100
-
-    Changed structure of repo
-
-commit 0827fce01800fc2e1b06b88e6b512dea175b0c17
-Author: Anton Matsson <antonmatsson@Antons-MBP.localdomain>
-Date:   Thu Feb 6 13:05:51 2020 +0100
-
-    updated code to get GAIL to run
-
-commit 8487d7460bddb193b89807daf7cbba9f71edbfd9
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 10:41:03 2020 +0100
-
-    added results
-
-commit c4e9060be81e8c522eef9da0ac9b1f12ba27ffd1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:56:40 2020 +0100
-
-    fin
-
-commit af0271a988f39d7ca5a1131b3d83665c22d9f8b1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:43:09 2020 +0100
-
-    hgi
-
-commit faf34d5f495f4f5424279e5823d168af86fd7291
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:38:52 2020 +0100
-
-    fixed requirements.txt
-
-commit d0bbd5cabbc023ddc00945620543c56372367146
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:08:25 2020 +0100
-
-    added deepirl
-
-commit 42a8f4d053ee85c5e3af9f72784c7d9b12ab841c
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:06:32 2020 +0100
-
-    fixni
-
-commit 13215698e0d7d48d404df1075c540037bc470a59
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Wed Feb 5 09:00:49 2020 +0100
-
-    added files for custom_env
-
-commit a66ca9391ddb2c236dd5f298e0bceafd9075ecf1
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 16:09:26 2020 +0100
-
-    fixed .npz file
-
-commit 0b63489dbb6b19ddb73690a5d5c0f0b12934eb06
-Author: Anton Matsson <antonmatsson@Antons-MacBook-Pro.local>
-Date:   Tue Feb 4 16:08:32 2020 +0100
-
-    created env
-
-commit bbcd047115f3ee96f2da2727e8ad4aed971d96b0
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:54:48 2020 +0100
-
-    added traj
-
-commit 0c14abe2ce6371bfec745f3b9c691ee3087b74f0
-Merge: 89e455b 585fa30
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:39:11 2020 +0100
-
-    gij
-
-commit 89e455b1ca41f8ffdda2e5c23c5cb27136565254
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:38:22 2020 +0100
-
-    gg
-
-commit d279635f1e9d5a8db48d2cf5b9320b67bafee70d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Feb 4 13:36:44 2020 +0100
-
-    changed in user class
-
-commit 585fa3013efb9d99a754cd70ed2199866ac6bbe1
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:19 2020 +0100
-
-    Delete gail_pendulum.zip
-
-commit a167dce17c312fdbdc0d1105cb1b02287ce43bd9
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Feb 3 14:15:10 2020 +0100
-
-    Delete expert_pendulum.npz
-
-commit 5d83000b84635f517ffd723a2f47424e75a16f80
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 16:30:13 2020 +0100
-
-    feature extraction + plots changed
-
-commit 060d3756ae019d5e9a0d032fdd81eadbe2b27f32
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 11:57:18 2020 +0100
-
-    added generate_data.py
-
-commit 216496211fab6141cd7fcc891228f8692350a3ff
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Thu Jan 30 08:41:26 2020 +0100
-
-    Tested different ways to compare time series
-
-commit 1bb9ce65c1de1ef824955e95327d1de2a445c37d
-Author: VictorGardi <victor.olssn@gmail.com>
-Date:   Tue Jan 21 15:17:48 2020 +0100
-
-    first commit
-
-commit d7ea0cae84fa116cf8ede93ff322132e8bc9bfcc
-Author: VictorGardi <45388014+VictorGardi@users.noreply.github.com>
-Date:   Mon Jan 20 09:53:42 2020 +0100
-
-    Initial commit
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-status.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-status.txt
deleted file mode 100644
index bba909f..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/git-status.txt
+++ /dev/null
@@ -1,30 +0,0 @@
-On branch master
-Your branch is up to date with 'origin/master'.
-
-Changes not staged for commit:
-  (use "git add/rm <file>..." to update what will be committed)
-  (use "git checkout -- <file>..." to discard changes in working directory)
-
-	deleted:    config.ini
-	modified:   customer_behaviour/algorithms/irl/airl/discriminator.py
-	modified:   customer_behaviour/algorithms/irl/common/utils/__init__.py
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/model.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/10_finish/optimizer.npz
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/args.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/command.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/environ.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-diff.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-head.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-log.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/git-status.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/scores.txt
-	deleted:    results/discrete_events/1_expert(s)/1_product(s)/2020-02-07_15-10-43/20200207T151047.033391/trajectories.npz
-	modified:   temp_main.py
-
-Untracked files:
-  (use "git add <file>..." to include in what will be committed)
-
-	results/airl/
-	results/gail/
-
-no changes added to commit (use "git add" and/or "git commit -a")
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/scores.txt b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/scores.txt
deleted file mode 100644
index 3f8062a..0000000
--- a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/scores.txt
+++ /dev/null
@@ -1 +0,0 @@
-steps	episodes	elapsed	mean	median	stdev	max	min	average_value	average_entropy	average_value_loss	average_policy_loss
diff --git a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/trajectories.npz b/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/trajectories.npz
deleted file mode 100644
index fc48d49..0000000
Binary files a/results/gail/discrete_events/1_expert(s)/1_product(s)/2020-02-10_10-21-58/20200210T102158.167908/trajectories.npz and /dev/null differ
